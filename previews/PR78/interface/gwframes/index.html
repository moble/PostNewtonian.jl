<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>GWFrames · PostNewtonian.jl</title><meta name="title" content="GWFrames · PostNewtonian.jl"/><meta property="og:title" content="GWFrames · PostNewtonian.jl"/><meta property="twitter:title" content="GWFrames · PostNewtonian.jl"/><meta name="description" content="Documentation for PostNewtonian.jl."/><meta property="og:description" content="Documentation for PostNewtonian.jl."/><meta property="twitter:description" content="Documentation for PostNewtonian.jl."/><meta property="og:url" content="https://moble.github.io/PostNewtonian.jl/stable/interface/gwframes/"/><meta property="twitter:url" content="https://moble.github.io/PostNewtonian.jl/stable/interface/gwframes/"/><link rel="canonical" href="https://moble.github.io/PostNewtonian.jl/stable/interface/gwframes/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PostNewtonian.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><span class="tocitem">Interface</span><ul><li><a class="tocitem" href="../high-level/">High-level interface</a></li><li><a class="tocitem" href="../units/">Units</a></li><li><a class="tocitem" href="../differentiation/">Automatic differentiation</a></li><li><a class="tocitem" href="../assorted_binaries/">Assorted binaries</a></li><li><a class="tocitem" href="../python/">Python</a></li><li class="is-active"><a class="tocitem" href>GWFrames</a></li></ul></li><li><span class="tocitem">Internals</span><ul><li><a class="tocitem" href="../../internals/code_structure/">Code structure</a></li><li><a class="tocitem" href="../../internals/pn_systems/">PN systems</a></li><li><a class="tocitem" href="../../internals/fundamental_variables/">Fundamental variables</a></li><li><a class="tocitem" href="../../internals/derived_variables/">Derived variables</a></li><li><a class="tocitem" href="../../internals/pn_expressions/">PN expressions</a></li><li><a class="tocitem" href="../../internals/dynamics/">Dynamics</a></li><li><a class="tocitem" href="../../internals/waveforms/">Waveforms</a></li><li><a class="tocitem" href="../../internals/utilities/">Utilities</a></li></ul></li><li><a class="tocitem" href="../../adding_terms/">Adding terms</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Interface</a></li><li class="is-active"><a href>GWFrames</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>GWFrames</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/moble/PostNewtonian.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/moble/PostNewtonian.jl/blob/main/docs/src/interface/gwframes.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="GWFrames-compatibility-layer"><a class="docs-heading-anchor" href="#GWFrames-compatibility-layer">GWFrames compatibility layer</a><a id="GWFrames-compatibility-layer-1"></a><a class="docs-heading-anchor-permalink" href="#GWFrames-compatibility-layer" title="Permalink"></a></h1><p><a href="https://github.com/moble/GWFrames"><code>GWFrames</code></a> is an old python package that was too hard to upgrade to python 3, and therefore became impossible to maintain.  Many of its capabilities have been superseded by the <a href="https://github.com/moble/scri"><code>scri</code></a> and <a href="https://github.com/sxs-collaboration/sxs/"><code>sxs</code></a> packages, but not the post-Newtonian capabilities.  This package now supersedes the latter.  For convenience, the <code>PostNewtonian.GWFrames</code> submodule provides a simple function to mimic the arguments used with the original <code>GWFrames</code> package to obtain a PN waveform (with a couple extra arguments).  We won&#39;t bother to provide a return type that can fully mimic the object returned by the original <code>GWFrames</code> package, though it should be similar to the ones used by <code>scri</code> and <code>sxs</code>.</p><p>This interface can be used directly from Julia, but is more likely to be wanted by python users.  To borrow from the example in <a href="../python/#Testing-the-installation">the standard python interface documentation</a>:</p><pre><code class="language-julia hljs"># Any python imports you need go here
import numpy as np
import matplotlib.pyplot as plt

# Start the Julia session
from sxs.julia import GWFrames

# Declare the essential parameters
delta = 0.0
chi1 = [0.1, 0.2, 0.3]
chi2 = [-0.2, 0.1, -0.3]
Omega_i = 0.01

# Call into Julia to run some function
w = GWFrames.PNWaveform(&quot;TaylorT1&quot;, delta, chi1, chi2, Omega_i)

# Plot the magnitudes of all the modes as functions of time
plt.semilogy(w.t, np.abs(w.data))</code></pre><p>This should produce precisely the same plot as the python example, but using the <code>GWFrames</code> interface.  Note that the parameters given here are required, but optional parameters are the same as in the original <code>GWFrames</code> interface — which are listed in full in the docstring below.</p><p>When called directly from Julia, the result will just be a <code>NamedTuple</code> with fields described in the docstring below.  When called from python as shown above, the resulting <code>w</code> will be an <a href="https://sxs.readthedocs.io/en/stable/api/waveforms/#waveformmodes-class"><code>sxs.WaveformModes</code> object</a>, with all the usual methods and properties, as well as several fields relevant to post-Newtonian waveforms:</p><ul><li><code>M1</code> (array): The primary mass as a function of time.</li><li><code>M2</code> (array): The secondary mass as a function of time.</li><li><code>chi1</code> (array): The primary spin as a function of time.</li><li><code>chi2</code> (array): The secondary spin as a function of time.</li><li><code>frame</code> (array): The quaternionic frame as a function of time.</li><li><code>v</code> (array): The orbital velocity as a function of time.</li><li><code>orbital_phase</code> (array): The orbital phase as a function of   time.</li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PostNewtonian.GWFrames.PNWaveform" href="#PostNewtonian.GWFrames.PNWaveform"><code>PostNewtonian.GWFrames.PNWaveform</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PNWaveform(Approximant, delta, chi1_i, chi2_i, Omega_orb_i; kwargs...)</code></pre><p>Compute a PN waveform, with the same call signature as <code>GWFrames.PNWaveform</code></p><p>This is essentially a compatibility layer for the corresponding function in the original <a href="https://github.com/moble/GWFrames/blob/01b39bfe/Code/PNWaveforms.cpp#L83-L88"><code>GWFrames</code></a> Python package, with several additional optional arguments: <code>inertial</code>, <code>dt</code>, <code>quiet</code>, <code>ell_min</code>, <code>ell_max</code>, <code>Lambda1</code>, and <code>Lambda2</code> (see below).  Also, this function accepts optional arguments either as positional arguments (which the original <code>GWFrames</code> requires) or as keyword arguments.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>We do <em>not</em> expect the result of this function to be identical to the result from the <code>GWFrames</code> Python package.  In particular, this package uses more general expressions for the tidal-heating terms, fixes an error in the 2PN quadratic-spin terms for the waveform modes, uses more accurate (and efficient) ODE integration, and uses a more accurate method to compute the number of steps per orbit (by default).</p><p>Also note that there are differences in the order of operations for computing intermediate variables.  Cancellation and roundoff error caused by these differences can have surprisingly large effects on the orbital evolution in many cases — particularly for precessing systems.  Results from the two packages have been painstakingly analyzed, leading to the conclusion that all differences are caused by such errors or the differences in formulations mentioned above.</p></div></div><p>The Julia interface is more detailed, flexible, and efficient than the simple <code>GWFrames</code> interface that this function emulates.  In particular, <a href="../../internals/dynamics/#PostNewtonian.orbital_evolution"><code>orbital_evolution</code></a> takes essentially all the same arguments that <a href="https://diffeq.sciml.ai/dev/basics/common_solver_opts/"><code>DifferentialEquations.solve</code></a> takes, and returns a <a href="https://diffeq.sciml.ai/dev/basics/solution/"><code>solution</code></a> that provides dense output and more details about the ODE solution itself.  For example, one reason this function is more efficient than <code>GWFrames</code> is that we can use dense output to solve with fewer timesteps, while accurately and efficiently interpolating to the requested timesteps.  While <code>orbital_evolution</code> solves for the dynamics, <a href="../../internals/waveforms/#PostNewtonian.coorbital_waveform"><code>coorbital_waveform</code></a> or <a href="../../internals/waveforms/#PostNewtonian.inertial_waveform"><code>inertial_waveform</code></a> provides the actual waveform; both are returned by this function.</p><p><strong>Required arguments</strong></p><ul><li><code>Approximant</code>: Currently, supported arguments are <code>&quot;TaylorT1&quot;</code>, <code>&quot;TaylorT4&quot;</code>, and <code>&quot;TaylorT5&quot;</code>.</li><li><code>delta</code>: Fractional mass difference <span>$(M₁-M₂)/(M₁+M₂)$</span></li><li><code>chi1_i</code>: Normalized spin vector <span>$S⃗₁/M₁²$</span></li><li><code>chi2_i</code>: Normalized spin vector <span>$S⃗₂/M₂²$</span></li><li><code>Omega_orb_i</code>: Orbital angular frequency at initial instant</li></ul><p><strong>Optional arguments</strong></p><p>As mentioned above, the following may be given <em>either</em> as positional arguments in this order (though any number of them may be omitted from the end), or as keyword arguments.</p><ul><li><code>Omega_orb_0=Omega_orb_i</code>: Orbital angular frequency at first instant found in data.  If this is less than <code>Omega_orb_i</code>, the system is integrated backwards in time from the latter value to this value.</li><li><code>R_frame_i=Rotor(1)</code>: Initial orientation of the frame.</li><li><code>MinStepsPerOrbit=32</code>: Number of time steps in the output data per orbit.  Because the waveform modes go as high as <span>$m=8$</span>, this number should be at least 16 to avoid Nyquist aliasing in those modes.  Note that this value may be overridden by <code>dt</code> (see below).</li><li><code>PNWaveformModeOrder=4.0</code>: Maximum PN order of terms in the waveform formulas.</li><li><code>PNOrbitalEvolutionOrder=4.0</code>: Maximum PN order of terms in the orbital-evolution formulas.</li><li><code>inertial=false</code>: If <code>true</code>, transform waveform to the inertial frame; otherwise, the waveform will be in the co-orbital frame.</li><li><code>dt=0</code>: Uniform time step size of the output.  If this is not a strictly positive number, <code>MinStepsPerOrbit</code> will be used instead.</li><li><code>quiet=true</code>: If <code>false</code>, show informational messages about the reasons for terminating the ODE integration.  In either case, warnings will still be issued if terminating for bad or suspicious reasons.  See the documentation of <a href="../../internals/dynamics/#PostNewtonian.orbital_evolution"><code>orbital_evolution</code></a> for an example of how to filter warnings also.</li><li><code>ell_min=2</code>: The lowest ℓ value in the output waveform.</li><li><code>ell_max=8</code>: The highest ℓ value in the output waveform.</li><li><code>Lambda1=0</code>: Tidal-coupling parameter of object 1.</li><li><code>Lambda2=0</code>: Tidal-coupling parameter of object 2.</li></ul><p><strong>Returned values</strong></p><p>This function returns a NamedTuple with the following keys:</p><ul><li><code>t</code>: The vector of time steps at which the data are evaluated.  The time <span>$t=0$</span> corresponds to the initial values that are arguments to this function.</li><li><code>data</code>: Matrix of complex values of the mode weights.  The shape is length(t) x 77.  The first dimension enumerates the values at each instant of time.  The second dimension enumerates the modes, starting with <span>$(2,-2)$</span>, then <span>$(2,-1)$</span>, up to <span>$(2,2)$</span>, followed by <span>$(3,-3)$</span>, and so on up to <span>$(8,8)$</span>.  This is the opposite ordering as results from <code>GWFrames</code>, but the same as the ordering used by the <code>sxs</code> and <code>scri</code> packages.  However, also note that certain conversions between Julia and Python <em>may</em> transpose matrices, because Julia is Fortran-ordered by default, whereas numpy is C-ordered.  It is best to check the shape manually to be sure which dimension is which.</li><li><code>frame</code>: Matrix of shape length(t) x 4 representing the frame-orientation quaternion as a function of time <code>t</code>.</li><li><code>M1</code>, <code>M2</code>: Vectors of the respective masses as functions of time <code>t</code>.  Note that only at the time corresponding to <code>Omega_orb_i</code> will the total mass be precisely 1. Generally, tidal heating will lead to time-dependent masses.</li><li><code>chi1</code>, <code>chi2</code>: Matrices of shape length(t) x 3 representing the spins as functions of time <code>t</code>.</li><li><code>v</code>: PN velocity parameter as a function of time <code>t</code>.</li><li><code>Phi</code>: Orbital phase as a function of time <code>t</code>.</li></ul><p>Because this is a NamedTuple, the fields can be accessed much like the fields of a <code>WaveformModes</code> object in the <code>scri</code> or <code>sxs</code> Python packages — as in <code>w.t</code> and <code>w.data</code>, where <code>w</code> is the object returned by this function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/PostNewtonian.jl/blob/06be8b7615798c0decf25c76e4a0774d35843b14/src/compatibility_layers/gwframes.jl#L6-L112">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../python/">« Python</a><a class="docs-footer-nextpage" href="../../internals/code_structure/">Code structure »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Friday 18 October 2024 18:52">Friday 18 October 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
