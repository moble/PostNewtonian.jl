<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>PN expressions ¬∑ PostNewtonian.jl</title><meta name="title" content="PN expressions ¬∑ PostNewtonian.jl"/><meta property="og:title" content="PN expressions ¬∑ PostNewtonian.jl"/><meta property="twitter:title" content="PN expressions ¬∑ PostNewtonian.jl"/><meta name="description" content="Documentation for PostNewtonian.jl."/><meta property="og:description" content="Documentation for PostNewtonian.jl."/><meta property="twitter:description" content="Documentation for PostNewtonian.jl."/><meta property="og:url" content="https://moble.github.io/PostNewtonian.jl/stable/internals/pn_expressions/"/><meta property="twitter:url" content="https://moble.github.io/PostNewtonian.jl/stable/internals/pn_expressions/"/><link rel="canonical" href="https://moble.github.io/PostNewtonian.jl/stable/internals/pn_expressions/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PostNewtonian.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><span class="tocitem">Interface</span><ul><li><a class="tocitem" href="../../interface/high-level/">High-level interface</a></li><li><a class="tocitem" href="../../interface/units/">Units</a></li><li><a class="tocitem" href="../../interface/differentiation/">Automatic differentiation</a></li><li><a class="tocitem" href="../../interface/assorted_binaries/">Assorted binaries</a></li><li><a class="tocitem" href="../../interface/python/">Python</a></li><li><a class="tocitem" href="../../interface/gwframes/">GWFrames</a></li></ul></li><li><span class="tocitem">Internals</span><ul><li><a class="tocitem" href="../code_structure/">Code structure</a></li><li><a class="tocitem" href="../pn_systems/">PN systems</a></li><li><a class="tocitem" href="../fundamental_variables/">Fundamental variables</a></li><li><a class="tocitem" href="../derived_variables/">Derived variables</a></li><li class="is-active"><a class="tocitem" href>PN expressions</a><ul class="internal"><li><a class="tocitem" href="#Binding-energy"><span>Binding energy</span></a></li><li><a class="tocitem" href="#Flux"><span>Flux</span></a></li><li><a class="tocitem" href="#Tidal-heating"><span>Tidal heating</span></a></li><li><a class="tocitem" href="#Separation"><span>Separation</span></a></li><li><a class="tocitem" href="#Precession"><span>Precession</span></a></li><li><a class="tocitem" href="#Mode-weights"><span>Mode weights</span></a></li></ul></li><li><a class="tocitem" href="../dynamics/">Dynamics</a></li><li><a class="tocitem" href="../waveforms/">Waveforms</a></li><li><a class="tocitem" href="../utilities/">Utilities</a></li></ul></li><li><a class="tocitem" href="../../adding_terms/">Adding terms</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Internals</a></li><li class="is-active"><a href>PN expressions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>PN expressions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/moble/PostNewtonian.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/moble/PostNewtonian.jl/blob/main/docs/src/internals/pn_expressions.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="PN-expressions"><a class="docs-heading-anchor" href="#PN-expressions">PN expressions</a><a id="PN-expressions-1"></a><a class="docs-heading-anchor-permalink" href="#PN-expressions" title="Permalink"></a></h1><p>These are collected from numerous sources in the literature.  The docstrings below provide the relevant citations.</p><h2 id="Binding-energy"><a class="docs-heading-anchor" href="#Binding-energy">Binding energy</a><a id="Binding-energy-1"></a><a class="docs-heading-anchor-permalink" href="#Binding-energy" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PostNewtonian.ùìî-Union{Tuple{Any}, Tuple{PNExpansionReducer}} where PNExpansionReducer" href="#PostNewtonian.ùìî-Union{Tuple{Any}, Tuple{PNExpansionReducer}} where PNExpansionReducer"><code>PostNewtonian.ùìî</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ùìî(pnsystem)
binding_energy(pnsystem)</code></pre><p>Compute the gravitational binding energy of a compact binary.</p><p>Note that this may not be as useful as its derivative, <a href="#PostNewtonian.ùìî‚Ä≤-Union{Tuple{PNSystem{ST, PNOrder}}, Tuple{PNExpansionReducer}, Tuple{PNOrder}, Tuple{ST}} where {ST, PNOrder, PNExpansionReducer}"><code>ùìî‚Ä≤</code></a>, which is used as part of the right-hand side for orbital evolutions.</p><p>The nonspinning orbital binding energy is known through 4pN.  The expressions through 3.5pN here come from Eq. (233) of <a href="https://doi.org/10.12942/lrr-2014-2">Blanchet (2014)</a>.</p><p>The 4pN term from Eq. (5.2d) of <a href="https://arxiv.org/abs/1303.3225v1">Jaranowski and Sch√§fer</a> is known exactly, now that the <span>$ŒΩ$</span>-linear piece is given as Eq. (32) of <a href="https://arxiv.org/abs/1305.4884v1">Bini and Damour (2013a)</a>.  The remaining terms are not known exactly, but <a href="https://arxiv.org/abs/1312.2503v2">Bini and Damour (2013b)</a> have derived some terms, though there is incomplete information, which are noted as the constants in this code.</p><p>The spin-orbit terms in the energy are now complete to 4.0pN (the last term is zero).  These terms come from Eq. (4.6) of <a href="https://arxiv.org/abs/1212.5520v2">Boh√© et al. (2012)</a>.</p><p>The spin-squared terms (by which we mean both spin-spin and spin-orbit squared terms) in the energy are known to 3pN order, and given in Eq. (3.33) of <a href="https://arxiv.org/abs/1501.01529">Boh√© et al. (2015)</a>.</p><p>The spin-cubed terms are known to 3.5pN order, and come from Eq. (6.17) of <a href="https://arxiv.org/abs/1411.4118">Marsat (2014)</a>.</p><p>The tidal-coupling terms come in to the binding energy at relative 5pN order, and are known to 6pN order.  These terms come from Eq. (2.11) of <a href="https://prd.aps.org/abstract/PRD/v83/i8/e084051">Vines et al. (2011)</a>.  Note their unusual convention for mass ratios, where <span>$œá‚ÇÅ = m‚ÇÅ/m$</span> in their notation; in particular, <span>$œá$</span> is not a spin parameter.  Also note that <span>$ŒªÃÇ = Œª‚ÇÇ v^{10}/(m‚ÇÅ+m‚ÇÇ)^5$</span>, and we need to add the coupling terms again with <span>$1 ‚Üî 2$</span>.  Finally, note the normalization difference, where a different overall factor is used, leading to a sign difference.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/PostNewtonian.jl/blob/806e8a852c90af3de29353d9d6ab13a2f2f637b8/src/pn_expressions/binding_energy.jl#L7-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PostNewtonian.ùìî‚Ä≤-Union{Tuple{PNSystem{ST, PNOrder}}, Tuple{PNExpansionReducer}, Tuple{PNOrder}, Tuple{ST}} where {ST, PNOrder, PNExpansionReducer}" href="#PostNewtonian.ùìî‚Ä≤-Union{Tuple{PNSystem{ST, PNOrder}}, Tuple{PNExpansionReducer}, Tuple{PNOrder}, Tuple{ST}} where {ST, PNOrder, PNExpansionReducer}"><code>PostNewtonian.ùìî‚Ä≤</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ùìî‚Ä≤(pnsystem)
binding_energy_deriv(pnsystem)</code></pre><p>Compute the derivative with respect to <span>$v$</span> of the binding energy of a compact binary.</p><p>This is computed automatically (via <code>FastDifferentiation</code>) from <a href="#PostNewtonian.ùìî-Union{Tuple{Any}, Tuple{PNExpansionReducer}} where PNExpansionReducer"><code>ùìî</code></a>; see that function for details of the PN formulas.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/PostNewtonian.jl/blob/806e8a852c90af3de29353d9d6ab13a2f2f637b8/src/pn_expressions/binding_energy.jl#L249-L257">source</a></section></article><h2 id="Flux"><a class="docs-heading-anchor" href="#Flux">Flux</a><a id="Flux-1"></a><a class="docs-heading-anchor-permalink" href="#Flux" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PostNewtonian.ùìï-Union{Tuple{Any}, Tuple{PNExpansionReducer}} where PNExpansionReducer" href="#PostNewtonian.ùìï-Union{Tuple{Any}, Tuple{PNExpansionReducer}} where PNExpansionReducer"><code>PostNewtonian.ùìï</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ùìï(pnsystem)
gw_energy_flux(pnsystem)</code></pre><p>Compute the gravitational-wave energy flux to infinity</p><p>The nonspinning flux terms are complete to 4.5pN order, and are given in Eq. (6.11) of <a href="https://arxiv.org/abs/2304.11186">Blanchet et al. (2023)</a>.</p><p>The spin-orbit terms in the flux are now known to 4.0pN.  These terms come from Eq. (4.9) of <a href="https://arxiv.org/abs/1307.6793v1">Marsat et al. (2013)</a></p><p>The spin-squared terms (by which we mean both spin-spin and spin-orbit squared terms) in the flux are known to 3pN order, and given most conveniently in Eq. (4.14) of <a href="https://arxiv.org/abs/1501.01529">Boh√© et al. (2015)</a>.</p><p>The spin-cubed terms are known to 3.5pN order, and come from Eq. (6.19) of <a href="https://arxiv.org/abs/1411.4118">Marsat (2014)</a>.</p><p>Beyond 4.5pN, terms are only known in the extreme-mass-ratio limit.  These terms are given in Appendix A of <a href="https://arxiv.org/abs/1211.5535v1">Fujita (2012)</a>.  He computed them up to 22pN.  That seems like overkill, so we&#39;ll just go up to 6pN.</p><p>For systems with matter, the tidal-heating terms come in at relative 5pN order, and are known partially at 6pN order.  These terms come from Eq. (3.6) of <a href="https://prd.aps.org/abstract/PRD/v83/i8/e084051">Vines et al. (2011)</a>.  Note their unusual convention for mass ratios, where <span>$œá‚ÇÅ = m‚ÇÅ/m$</span> in their notation; in particular, <span>$œá$</span> is not a spin parameter.  Also note that <span>$ŒªÃÇ = Œª‚ÇÇ v^{10}/(m‚ÇÅ+m‚ÇÇ)^5$</span>, and we need to add the coupling terms again with <span>$1 ‚Üî 2$</span>.  Finally, note the normalization difference, where a different overall factor is used, leading to a sign difference.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/PostNewtonian.jl/blob/806e8a852c90af3de29353d9d6ab13a2f2f637b8/src/pn_expressions/flux.jl#L1-L31">source</a></section></article><h2 id="Tidal-heating"><a class="docs-heading-anchor" href="#Tidal-heating">Tidal heating</a><a id="Tidal-heating-1"></a><a class="docs-heading-anchor-permalink" href="#Tidal-heating" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PostNewtonian.tidal_heating-Union{Tuple{Any}, Tuple{PNExpansionReducer}} where PNExpansionReducer" href="#PostNewtonian.tidal_heating-Union{Tuple{Any}, Tuple{PNExpansionReducer}} where PNExpansionReducer"><code>PostNewtonian.tidal_heating</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tidal_heating(pnsystem)</code></pre><p>Compute the rate of energy and angular-momentum absorption into each black hole in a binary.</p><p>The returned quantity is a tuple <code>(SÃá‚ÇÅ, MÃá‚ÇÅ, SÃá‚ÇÇ, MÃá‚ÇÇ)</code>, representing the corresponding rates of change of spin (magnitude) and mass on black hole 1 and black hole 2.  These apply to general ‚Äî possibly precessing ‚Äî non-eccentric binaries.  This collection of terms comes from <a href="https://doi.org/10.1103/PhysRevD.64.104020">Alvi (2001)</a>.  It probably wouldn&#39;t be too hard to extend Alvi&#39;s analysis to eccentric systems.</p><p>Note that the validity of the result depends not only on the PN parameter <span>$v$</span>, but also on the angles of the spins relative to the separation vector <span>$nÃÇ$</span>: the smaller the angle, the lower the <span>$v$</span> at which the approximations should be expected to break down.</p><p>See also</p><ul><li><a href="http://arxiv.org/abs/gr-qc/9405062">Tagoshi and Sasaki (1994)</a></li><li><a href="https://arxiv.org/abs/gr-qc/9412027">Poisson and Sasaki (1995)</a></li><li><a href="https://arxiv.org/abs/gr-qc/9711072">Tagoshi et al. (1997)</a></li><li><a href="https://arxiv.org/abs/0710.5150">Porto (2007)</a></li><li><a href="https://arxiv.org/abs/1211.1686">Chatziioannou et al. (2012)</a></li></ul><p>See the documentation section on <a href="../derived_variables/#Horizons">&quot;Horizons&quot;</a> for details about the computation of horizon quantities used in this function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/PostNewtonian.jl/blob/806e8a852c90af3de29353d9d6ab13a2f2f637b8/src/pn_expressions/tidal_heating.jl#L1-L27">source</a></section></article><h2 id="Separation"><a class="docs-heading-anchor" href="#Separation">Separation</a><a id="Separation-1"></a><a class="docs-heading-anchor-permalink" href="#Separation" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PostNewtonian.r-Union{Tuple{Any}, Tuple{PNExpansionReducer}, Tuple{Any, Any}} where PNExpansionReducer" href="#PostNewtonian.r-Union{Tuple{Any}, Tuple{PNExpansionReducer}, Tuple{Any, Any}} where PNExpansionReducer"><code>PostNewtonian.r</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">r(pnsystem, [r‚ÇÄ‚Ä≤])
separation(pnsystem, [r‚ÇÄ‚Ä≤])</code></pre><p>Compute the separation between the two black holes.  This is essentially the multiplicative inverse of <a href="#PostNewtonian.Œ≥‚Çö‚Çô-Union{Tuple{Any}, Tuple{PNExpansionReducer}, Tuple{Any, Any}} where PNExpansionReducer"><code>Œ≥‚Çö‚Çô</code></a>, with some factors of <code>G</code> and <code>M</code> thrown in.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/PostNewtonian.jl/blob/806e8a852c90af3de29353d9d6ab13a2f2f637b8/src/pn_expressions/separation.jl#L269-L275">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PostNewtonian.r‚Ä≤-Union{Tuple{Any}, Tuple{PNExpansionReducer}, Tuple{Any, Any}} where PNExpansionReducer" href="#PostNewtonian.r‚Ä≤-Union{Tuple{Any}, Tuple{PNExpansionReducer}, Tuple{Any, Any}} where PNExpansionReducer"><code>PostNewtonian.r‚Ä≤</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">r‚Ä≤(pnsystem, [r‚ÇÄ‚Ä≤])
separation_deriv(pnsystem, [r‚ÇÄ‚Ä≤])</code></pre><p>Compute the derivative of the separation between the two black holes with respect to <code>v</code>.</p><p>Note that we ignore a derivative of <code>M</code> that appears in the <code>r‚ÇÄ‚Ä≤</code> term, as explained in <a href="#PostNewtonian.Œ≥‚Çö‚Çô‚Ä≤-Union{Tuple{Any}, Tuple{PNExpansionReducer}} where PNExpansionReducer"><code>Œ≥‚Çö‚Çô‚Ä≤</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/PostNewtonian.jl/blob/806e8a852c90af3de29353d9d6ab13a2f2f637b8/src/pn_expressions/separation.jl#L284-L292">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PostNewtonian.r‚Åª¬π" href="#PostNewtonian.r‚Åª¬π"><code>PostNewtonian.r‚Åª¬π</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">r‚Åª¬π(r, pnsystem, [r‚ÇÄ‚Ä≤])
separation_inverse(r, pnsystem, [r‚ÇÄ‚Ä≤])</code></pre><p>Return <code>v</code> such that <code>r = r(v)</code> when <code>pnsystem</code> is evaluated at <code>v</code>.</p><p>Note that the value of <code>v</code> in the input <code>pnsystem</code> is ignored; you may use any value.  It may also be convenient to know that you can set the value of <code>v</code> in <code>pnsystem</code> to the returned value using <code>PostNewtonian.vindex</code> as in</p><pre><code class="language-julia hljs">pnsystem.state[PostNewtonian.vindex] = r‚Åª¬π(r, pnsystem)</code></pre><p>See also <a href="#PostNewtonian.Œ≥‚Çö‚Çô‚Åª¬π"><code>Œ≥‚Çö‚Çô‚Åª¬π</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/PostNewtonian.jl/blob/806e8a852c90af3de29353d9d6ab13a2f2f637b8/src/pn_expressions/separation.jl#L381-L394">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PostNewtonian.Œ≥‚Çö‚Çô-Union{Tuple{Any}, Tuple{PNExpansionReducer}, Tuple{Any, Any}} where PNExpansionReducer" href="#PostNewtonian.Œ≥‚Çö‚Çô-Union{Tuple{Any}, Tuple{PNExpansionReducer}, Tuple{Any, Any}} where PNExpansionReducer"><code>PostNewtonian.Œ≥‚Çö‚Çô</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Œ≥‚Çö‚Çô(pnsystem, [r‚ÇÄ‚Ä≤])
inverse_separation(pnsystem, [r‚ÇÄ‚Ä≤])</code></pre><p>Compute the post-Newtonian parameter</p><p class="math-container">\[\gamma_{\mathrm{PN}} \equiv \frac{G\, M}{r\, c^2},\]</p><p>where <span>$r$</span> is the magnitude of the orbital separation.  This quantity has PN order 1, and is given by Eq. (4.3) of <a href="https://arxiv.org/abs/1212.5520">Boh√© et al. (2013)</a>, with spin-squared terms from Eq.  (3.32) of <a href="https://arxiv.org/abs/1501.01529">Boh√© et al. (2015)</a> and spin-cubed terms from <a href="https://arxiv.org/abs/1411.4118">Marsat (2014)</a>.</p><p>Note that there is a 3PN gauge term of <span>$-22ŒΩ\ln(r/r‚ÇÄ&#39;)/3$</span>.  While this value should cancel out of any physical quantity, it is included here for completeness.  Computing it requires a few Newton steps to get the value of <span>$Œ≥$</span> because the <span>$\ln(r)$</span> term depends on <span>$\gamma$</span>.</p><p>Specifically, we use the helper function <a href="#PostNewtonian.Œ≥‚Çö‚Çô‚ÇÄ-Union{Tuple{Any}, Tuple{PNExpansionReducer}, Tuple{Any, Any}} where PNExpansionReducer"><code>Œ≥‚Çö‚Çô‚ÇÄ</code></a> to write <code>Œ≥‚Çö‚Çô = Œ≥‚Çö‚Çô‚ÇÄ + (v/c)^8 * (22ln(Œ≥‚Çö‚Çô)/3)ŒΩ</code>; given the value of <code>Œ≥‚Çö‚Çô‚ÇÄ</code>, the purpose of this function is to determine <code>Œ≥‚Çö‚Çô</code>.</p><p>The default value of <code>r‚ÇÄ&#39;</code> is <code>G*M/c^2</code>, which makes its contribution vanish.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/PostNewtonian.jl/blob/806e8a852c90af3de29353d9d6ab13a2f2f637b8/src/pn_expressions/separation.jl#L71-L95">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PostNewtonian.Œ≥‚Çö‚Çô‚Ä≤-Union{Tuple{Any}, Tuple{PNExpansionReducer}} where PNExpansionReducer" href="#PostNewtonian.Œ≥‚Çö‚Çô‚Ä≤-Union{Tuple{Any}, Tuple{PNExpansionReducer}} where PNExpansionReducer"><code>PostNewtonian.Œ≥‚Çö‚Çô‚Ä≤</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Œ≥‚Çö‚Çô‚Ä≤(pnsystem)
inverse_separation_deriv(pnsystem)</code></pre><p>Compute the derivative of <a href="#PostNewtonian.Œ≥‚Çö‚Çô-Union{Tuple{Any}, Tuple{PNExpansionReducer}, Tuple{Any, Any}} where PNExpansionReducer"><code>Œ≥‚Çö‚Çô</code></a> with respect to <code>v</code>.</p><p>Note that we ignore the <code>r‚ÇÄ‚Ä≤</code> term in this function; that constant is obviously independent of <code>v</code>, though it is multiplied by <code>M</code>, which is not independent of <code>v</code>.  This dependence, however, should be at a much higher PN order than is currently available in any case, so we ignore it for simplicity.</p><p>This computation uses <a href="#PostNewtonian.Œ≥‚Çö‚Çô‚ÇÄ-Union{Tuple{Any}, Tuple{PNExpansionReducer}, Tuple{Any, Any}} where PNExpansionReducer"><code>Œ≥‚Çö‚Çô‚ÇÄ</code></a> along with the following derivation:</p><p class="math-container">\[\begin{align*}
Œ≥‚Çö‚Çô &amp;= Œ≥‚Çö‚Çô‚ÇÄ + (v/c)^8 (22 \ln(Œ≥‚Çö‚Çô)/3)ŒΩ \\
Œ≥‚Çö‚Çô&#39; &amp;= Œ≥‚Çö‚Çô‚ÇÄ&#39; + 8(v/c)^7 (22 \ln(Œ≥‚Çö‚Çô)/3)ŒΩ + (v/c)^8 (22 Œ≥‚Çö‚Çô&#39;/3Œ≥‚Çö‚Çô)ŒΩ \\
Œ≥‚Çö‚Çô&#39; &amp;= \frac{Œ≥‚Çö‚Çô‚ÇÄ&#39; + 8(v/c)^7 (22 \ln(Œ≥‚Çö‚Çô)/3)ŒΩ} {1 - (v/c)^8 (22/3Œ≥‚Çö‚Çô)ŒΩ}
\end{align*}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/PostNewtonian.jl/blob/806e8a852c90af3de29353d9d6ab13a2f2f637b8/src/pn_expressions/separation.jl#L133-L153">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PostNewtonian.Œ≥‚Çö‚Çô‚Åª¬π" href="#PostNewtonian.Œ≥‚Çö‚Çô‚Åª¬π"><code>PostNewtonian.Œ≥‚Çö‚Çô‚Åª¬π</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Œ≥‚Çö‚Çô‚Åª¬π(Œ≥, pnsystem, [r‚ÇÄ‚Ä≤])
inverse_separation_inverse(Œ≥, pnsystem, [r‚ÇÄ‚Ä≤])</code></pre><p>Return <code>v</code> such that <code>Œ≥‚Çö‚Çô(pnsystem, r‚ÇÄ‚Ä≤) = Œ≥</code> when <code>pnsystem</code> is evaluated at <code>v</code>.</p><p>Note that the value of <code>v</code> in the input <code>pnsystem</code> is ignored; you may use any value.  It may also be convenient to know that you can set the value of <code>v</code> in <code>pnsystem</code> to the returned value using <code>PostNewtonian.vindex</code> as in</p><pre><code class="language-julia hljs">pnsystem.state[PostNewtonian.vindex] = Œ≥‚Çö‚Çô‚Åª¬π(Œ≥, pnsystem)</code></pre><p>See also <a href="#PostNewtonian.r‚Åª¬π"><code>r‚Åª¬π</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/PostNewtonian.jl/blob/806e8a852c90af3de29353d9d6ab13a2f2f637b8/src/pn_expressions/separation.jl#L315-L328">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PostNewtonian.Œ≥‚Çö‚Çô‚ÇÄ-Union{Tuple{Any}, Tuple{PNExpansionReducer}, Tuple{Any, Any}} where PNExpansionReducer" href="#PostNewtonian.Œ≥‚Çö‚Çô‚ÇÄ-Union{Tuple{Any}, Tuple{PNExpansionReducer}, Tuple{Any, Any}} where PNExpansionReducer"><code>PostNewtonian.Œ≥‚Çö‚Çô‚ÇÄ</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Œ≥‚Çö‚Çô‚ÇÄ(pnsystem, [r‚ÇÄ‚Ä≤])</code></pre><p>This is a helper function for <a href="#PostNewtonian.Œ≥‚Çö‚Çô-Union{Tuple{Any}, Tuple{PNExpansionReducer}, Tuple{Any, Any}} where PNExpansionReducer"><code>Œ≥‚Çö‚Çô</code></a>; this computes the portion of <code>Œ≥‚Çö‚Çô</code> that does not depend on the logarithm of the separation.  Since <code>Œ≥‚Çö‚Çô</code> is defined in terms of the separation, that term makes the standard definition into an implicit function.</p><p>Specifically, <code>Œ≥‚Çö‚Çô = Œ≥‚Çö‚Çô‚ÇÄ - (v/c)^8 * (22ln(r*c^2/(G*M)) / 3)ŒΩ</code>, where the argument of the logarithm is precisely <code>1/Œ≥‚Çö‚Çô</code> ‚Äî by definition.  Note that there is a term just like the second term in the expression that involves <code>r‚ÇÄ‚Ä≤</code>, which is a gauge parameter.  By default, that term is simply ignored in this function, but if the optional argument is provided, it is included.  This combination of the logarithms involving <code>r</code> and <code>r‚ÇÄ‚Ä≤</code> should drop out of the result for any physical quantity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/PostNewtonian.jl/blob/806e8a852c90af3de29353d9d6ab13a2f2f637b8/src/pn_expressions/separation.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PostNewtonian.Œ≥‚Çö‚Çô‚ÇÄ‚Ä≤-Union{Tuple{PNSystem{ST, PNOrder}}, Tuple{PNExpansionReducer}, Tuple{PNOrder}, Tuple{ST}} where {ST, PNOrder, PNExpansionReducer}" href="#PostNewtonian.Œ≥‚Çö‚Çô‚ÇÄ‚Ä≤-Union{Tuple{PNSystem{ST, PNOrder}}, Tuple{PNExpansionReducer}, Tuple{PNOrder}, Tuple{ST}} where {ST, PNOrder, PNExpansionReducer}"><code>PostNewtonian.Œ≥‚Çö‚Çô‚ÇÄ‚Ä≤</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Œ≥‚Çö‚Çô‚ÇÄ‚Ä≤(pnsystem)</code></pre><p>Helper function to compute <a href="#PostNewtonian.Œ≥‚Çö‚Çô‚Ä≤-Union{Tuple{Any}, Tuple{PNExpansionReducer}} where PNExpansionReducer"><code>Œ≥‚Çö‚Çô‚Ä≤</code></a>.  This just computes the derivative of <a href="#PostNewtonian.Œ≥‚Çö‚Çô‚ÇÄ-Union{Tuple{Any}, Tuple{PNExpansionReducer}, Tuple{Any, Any}} where PNExpansionReducer"><code>Œ≥‚Çö‚Çô‚ÇÄ</code></a> with respect to <code>v</code>; <code>Œ≥‚Çö‚Çô‚Ä≤</code> takes care of the extra complications arising from the Newton iterations in <a href="#PostNewtonian.Œ≥‚Çö‚Çô‚Ä≤-Union{Tuple{Any}, Tuple{PNExpansionReducer}} where PNExpansionReducer"><code>Œ≥‚Çö‚Çô‚Ä≤</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/PostNewtonian.jl/blob/806e8a852c90af3de29353d9d6ab13a2f2f637b8/src/pn_expressions/separation.jl#L175-L182">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PostNewtonian.·πô-Union{Tuple{Any}, Tuple{PNExpansionReducer}, Tuple{Any, Any}} where PNExpansionReducer" href="#PostNewtonian.·πô-Union{Tuple{Any}, Tuple{PNExpansionReducer}, Tuple{Any, Any}} where PNExpansionReducer"><code>PostNewtonian.·πô</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rÃá(pnsystem, [r‚ÇÄ‚Ä≤])
separation_dot(pnsystem, [r‚ÇÄ‚Ä≤])</code></pre><p>Compute the derivative of the separation between the two black holes with respect to time.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/PostNewtonian.jl/blob/806e8a852c90af3de29353d9d6ab13a2f2f637b8/src/pn_expressions/separation.jl#L301-L306">source</a></section></article><h3 id="Kidder-(1995)"><a class="docs-heading-anchor" href="#Kidder-(1995)">Kidder (1995)</a><a id="Kidder-(1995)-1"></a><a class="docs-heading-anchor-permalink" href="#Kidder-(1995)" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PostNewtonian.Kidder1995" href="#PostNewtonian.Kidder1995"><code>PostNewtonian.Kidder1995</code></a> ‚Äî <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>This module contains a few expressions from <a href="https://arxiv.org/abs/gr-qc/9506022">Kidder (1995)</a>.</p><p>This is mostly here for testing, because these expressions are not directly used in this package: they are somewhat outdated and describe quantities that are not actually used in this formulation.  However, they were used in the SpEC code as an initial guess for eccentricity reduction, so we want to make sure that results from this package are consistent with those from SpEC.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/PostNewtonian.jl/blob/806e8a852c90af3de29353d9d6ab13a2f2f637b8/src/pn_expressions/separation.jl#L404-L414">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PostNewtonian.Kidder1995.r-Union{Tuple{Any}, Tuple{PNExpansionReducer}} where PNExpansionReducer" href="#PostNewtonian.Kidder1995.r-Union{Tuple{Any}, Tuple{PNExpansionReducer}} where PNExpansionReducer"><code>PostNewtonian.Kidder1995.r</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">r(pnsystem)</code></pre><p>Eq. (4.13).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/PostNewtonian.jl/blob/806e8a852c90af3de29353d9d6ab13a2f2f637b8/src/pn_expressions/separation.jl#L432-L436">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PostNewtonian.Kidder1995.·πô-Union{Tuple{Any}, Tuple{PNExpansionReducer}} where PNExpansionReducer" href="#PostNewtonian.Kidder1995.·πô-Union{Tuple{Any}, Tuple{PNExpansionReducer}} where PNExpansionReducer"><code>PostNewtonian.Kidder1995.·πô</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rÃá(pnsystem)</code></pre><p>Eq. (4.12), computed as rÃá = (dE/dt) / (dE/dr), re-expanded and truncated.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/PostNewtonian.jl/blob/806e8a852c90af3de29353d9d6ab13a2f2f637b8/src/pn_expressions/separation.jl#L454-L458">source</a></section></article><h2 id="Precession"><a class="docs-heading-anchor" href="#Precession">Precession</a><a id="Precession-1"></a><a class="docs-heading-anchor-permalink" href="#Precession" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PostNewtonian.a‚Çó-Union{Tuple{Any}, Tuple{PNExpansionReducer}} where PNExpansionReducer" href="#PostNewtonian.a‚Çó-Union{Tuple{Any}, Tuple{PNExpansionReducer}} where PNExpansionReducer"><code>PostNewtonian.a‚Çó</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">a‚Çó(pnsystem)</code></pre><p>Eq. (4.4) of <a href="https://arxiv.org/abs/1212.5520">Boh√© et al. (2013)</a>.  This term contributes to <a href="#PostNewtonian.ùõ°-Union{Tuple{Any}, Tuple{PNExpansionReducer}} where PNExpansionReducer"><code>ùõ°</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/PostNewtonian.jl/blob/806e8a852c90af3de29353d9d6ab13a2f2f637b8/src/pn_expressions/precession.jl#L40-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PostNewtonian.Œ©‚Éó·µ™-NTuple{8, Any}" href="#PostNewtonian.Œ©‚Éó·µ™-NTuple{8, Any}"><code>PostNewtonian.Œ©‚Éó·µ™</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Œ©‚Éó·µ™(M‚±º, M‚Çñ, œá‚Éó‚±º, œá‚Éó‚Çñ, R)</code></pre><p>Compute the angular velocity of precession of spin vector <code>œá‚Éó‚±º</code>.</p><p>In the approximation that the spin <em>magnitude</em> is constant, the time derivative of <span>$œá‚Éó‚±º$</span> is due to its rotation alone, and is given by <span>$Œ©‚Éó·µ™ √ó œá‚Éó‚±º$</span>.</p><p>Note that this function is called by <a href="#PostNewtonian.Œ©‚Éó·µ™‚ÇÅ-Union{Tuple{Any}, Tuple{PNExpansionReducer}} where PNExpansionReducer"><code>Œ©‚Éó·µ™‚ÇÅ</code></a> and <a href="#PostNewtonian.Œ©‚Éó·µ™‚ÇÇ-Union{Tuple{Any}, Tuple{PNExpansionReducer}} where PNExpansionReducer"><code>Œ©‚Éó·µ™‚ÇÇ</code></a> with the appropriate parameters; you probably want to use those instead of this one.</p><p>The spin-spin term is given by Eq. (2.4) of <a href="http://link.aps.org/doi/10.1103/PhysRevD.52.821">Kidder (1995)</a>; the spin-orbit terms by Eq. (4.5) of <a href="http://arxiv.org/abs/1212.5520v2">Boh√© et al. (2013)</a>; and the quadrupole-monopole term by Eq. (2.7) <a href="http://link.aps.org/doi/10.1103/PhysRevD.78.044021">Racine (2008)</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/PostNewtonian.jl/blob/806e8a852c90af3de29353d9d6ab13a2f2f637b8/src/pn_expressions/precession.jl#L89-L104">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PostNewtonian.Œ©‚Éó·µ™‚ÇÅ-Union{Tuple{Any}, Tuple{PNExpansionReducer}} where PNExpansionReducer" href="#PostNewtonian.Œ©‚Éó·µ™‚ÇÅ-Union{Tuple{Any}, Tuple{PNExpansionReducer}} where PNExpansionReducer"><code>PostNewtonian.Œ©‚Éó·µ™‚ÇÅ</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Œ©‚Éó·µ™‚ÇÅ(pnsystem)</code></pre><p>Compute the angular velocity of precession of œá‚Éó‚ÇÅ</p><p>In the approximation that the spin <em>magnitude</em> is constant, the time derivative of <span>$œá‚Éó‚ÇÅ$</span> is due to its rotation alone, and is given by <span>$Œ©‚Éó·µ™‚ÇÅ √ó œá‚Éó‚ÇÅ$</span>.</p><p>Note that this function simply calls <a href="#PostNewtonian.Œ©‚Éó·µ™-NTuple{8, Any}"><code>Œ©‚Éó·µ™</code></a> with the appropriate parameters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/PostNewtonian.jl/blob/806e8a852c90af3de29353d9d6ab13a2f2f637b8/src/pn_expressions/precession.jl#L55-L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PostNewtonian.Œ©‚Éó·µ™‚ÇÇ-Union{Tuple{Any}, Tuple{PNExpansionReducer}} where PNExpansionReducer" href="#PostNewtonian.Œ©‚Éó·µ™‚ÇÇ-Union{Tuple{Any}, Tuple{PNExpansionReducer}} where PNExpansionReducer"><code>PostNewtonian.Œ©‚Éó·µ™‚ÇÇ</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Œ©‚Éó·µ™‚ÇÇ(pnsystem)</code></pre><p>Compute the angular velocity of precession of œá‚Éó‚ÇÇ</p><p>In the approximation that the spin <em>magnitude</em> is constant, the time derivative of <span>$œá‚Éó‚ÇÇ$</span> is due to its rotation alone, and is given by <span>$Œ©‚Éó·µ™‚ÇÇ √ó œá‚Éó‚ÇÇ$</span>.</p><p>Note that this function simply calls <a href="#PostNewtonian.Œ©‚Éó·µ™-NTuple{8, Any}"><code>Œ©‚Éó·µ™</code></a> with the appropriate parameters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/PostNewtonian.jl/blob/806e8a852c90af3de29353d9d6ab13a2f2f637b8/src/pn_expressions/precession.jl#L72-L81">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PostNewtonian.Œ©‚Éó‚Çö-Tuple{Any}" href="#PostNewtonian.Œ©‚Éó‚Çö-Tuple{Any}"><code>PostNewtonian.Œ©‚Éó‚Çö</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Œ©‚Éó‚Çö(pnsystem)</code></pre><p>Compute the angular velocity of orbital precession.</p><p>This is the angular velocity <em>of</em> the orbital angular velocity direction unit vector <span>$‚ÑìÃÇ$</span>; the time derivative of that <em>unit</em> vector is <span>$Œ©‚Éó‚Çö √ó ‚ÑìÃÇ$</span>.</p><p>At the moment, this is computed solely by expressions from <a href="https://arxiv.org/abs/1212.5520">Boh√© et al. (2013)</a>.  See <a href="#PostNewtonian.ùõ°-Union{Tuple{Any}, Tuple{PNExpansionReducer}} where PNExpansionReducer"><code>ùõ°</code></a> for details.</p><p>See also <a href="../fundamental_variables/#PostNewtonian.FundamentalVariables.R"><code>R</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/PostNewtonian.jl/blob/806e8a852c90af3de29353d9d6ab13a2f2f637b8/src/pn_expressions/precession.jl#L1-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PostNewtonian.ùõ°-Union{Tuple{Any}, Tuple{PNExpansionReducer}} where PNExpansionReducer" href="#PostNewtonian.ùõ°-Union{Tuple{Any}, Tuple{PNExpansionReducer}} where PNExpansionReducer"><code>PostNewtonian.ùõ°</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ùõ°(pnsystem)</code></pre><p>Compute the angular velocity of orbital precession according to Boh√© et al.</p><p>As <a href="https://arxiv.org/abs/1212.5520">Boh√© et al. (2013)</a> explain above their Eq. (4.1), the orbital precession is given by the time derivative of the orbital axis: ùìµÃá = ùõ° √ó ùìµ, where the angular velocity is along the separation vector ùì∑, so that ùõ° = œñ ùì∑.  And in turn, they define a‚Çó ‚âî r œâ œñ, where r is the separation and œâ is the orbital angular frequency. Then, they define the PN parameter Œ≥‚Çö‚Çô‚âîM/r and we have Mœâ = v¬≥ so that œñ = Œ≥‚Çö‚Çô a‚Çó / v¬≥.  The parameters Œ≥‚Çö‚Çô and a‚Çó are given by Eqs. (4.3) and (4.4), and given here by the functions <a href="#PostNewtonian.Œ≥‚Çö‚Çô-Union{Tuple{Any}, Tuple{PNExpansionReducer}, Tuple{Any, Any}} where PNExpansionReducer"><code>Œ≥‚Çö‚Çô</code></a> and <a href="#PostNewtonian.a‚Çó-Union{Tuple{Any}, Tuple{PNExpansionReducer}} where PNExpansionReducer"><code>a‚Çó</code></a>.</p><p>The spin-squared terms (by which we mean both spin-spin and spin-orbit squared terms) in the energy are known to 3pN order, and given in <a href="https://arxiv.org/abs/1501.01529">Eq. (3.32) of Boh√© et al. (2015)</a>.</p><p>See also <a href="../fundamental_variables/#PostNewtonian.FundamentalVariables.R"><code>R</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/PostNewtonian.jl/blob/806e8a852c90af3de29353d9d6ab13a2f2f637b8/src/pn_expressions/precession.jl#L17-L35">source</a></section></article><h2 id="Mode-weights"><a class="docs-heading-anchor" href="#Mode-weights">Mode weights</a><a id="Mode-weights-1"></a><a class="docs-heading-anchor-permalink" href="#Mode-weights" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PostNewtonian.h!-Union{Tuple{PNExpansionReducer}, Tuple{Any, Any}} where PNExpansionReducer" href="#PostNewtonian.h!-Union{Tuple{PNExpansionReducer}, Tuple{Any, Any}} where PNExpansionReducer"><code>PostNewtonian.h!</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">h!(h, pnsystem; ‚Ñì‚Çò·µ¢‚Çô=0, ‚Ñì‚Çò‚Çê‚Çì=typemax(Int))
mode_weights!(h, pnsystem; ‚Ñì‚Çò·µ¢‚Çô=0, ‚Ñì‚Çò‚Çê‚Çì=typemax(Int))</code></pre><p>Compute mode weights of gravitational waves emitted by <code>pn</code> system, modifying <code>h</code> in place.</p><div class="admonition is-info" id="Note-23a527b1ffd8e66c"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-23a527b1ffd8e66c" title="Permalink"></a></header><div class="admonition-body"><p>This is a low-level function; you probably don&#39;t want to use this directly.  See <a href="../waveforms/#PostNewtonian.coorbital_waveform"><code>coorbital_waveform</code></a> or <a href="../waveforms/#PostNewtonian.inertial_waveform"><code>inertial_waveform</code></a> for more user-friendly functions.</p></div></div><p>These modes are computed in the &quot;co-orbital&quot; frame, in which the larger object lies on the positive <span>$x$</span> axis, the smaller lies on the negative <span>$x$</span> axis, and the instantaneous angular velocity is in the positive <span>$z$</span> direction.</p><p>The modes are stored in <code>h</code> in order of increasing <span>$‚Ñì$</span> and increasing <span>$m$</span>, with <span>$m$</span> iterating fastest, all the way up to the highest available mode, <span>$(8,8)$</span>.</p><p>Because gravitational waves have spin weight -2, the <span>$(‚Ñì,m)=(0,0)$</span>, <span>$(1,-1)$</span>, <span>$(1,0)$</span>, and <span>$(1,1)$</span> modes are always 0.  By default, we assume that these modes are nonetheless included in <code>h</code>.  If that is not the case, set <code>‚Ñì‚Çò·µ¢‚Çô</code> to the smallest <span>$‚Ñì$</span> value that should be present in the output data ‚Äî <code>‚Ñì‚Çò·µ¢‚Çô=2</code> being the most reasonable alternative.</p><p>These results come most directly from Eqs. (A5) of <a href="https://arxiv.org/abs/1409.4431">Boyle et al. (2014)</a>, with the exception of errors in the 2PN spin-spin terms, in which cases we must multiply by <span>$\nu/2$</span> and make the substitutions <span>$S_1 \mapsto S_0^+$</span> and <span>$S_2 \mapsto S_0^-$</span>.  In turn, those expressions are synthesized from the following:  Non-spinning terms are taken from <a href="https://doi.org/10.12942/lrr-2014-2">Blanchet (2014)</a>, except for the highest-pN term in the (2,¬±2) mode, which are taken from <a href="https://arxiv.org/abs/2304.11186">Blanchet et al.  (2023)</a>, and the <span>$m=0$</span> modes, which are taken from <a href="https://arxiv.org/abs/0812.0069">Favata (2008)</a>. The 1PN spin-orbit term is from Eq. (3.22d) of <a href="https://link.aps.org/doi/10.1103/PhysRevD.52.821">Kidder (1995)</a>.  The 1.5PN spin-orbit term is from Eq. (3.22f) of Kidder (1995) and Eq. (F15b) of <a href="https://link.aps.org/doi/10.1103/PhysRevD.54.4813">Will and Wiseman (1996)</a>.  The 2PN spin-orbit term is from Eq. (4.13) of <a href="https://link.aps.org/doi/10.1103/PhysRevD.87.044009">Buonanno, Faye, Hinderer (2013)</a>, while the 2PN spin-spin term is from Eq. (4.15) of that reference.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/PostNewtonian.jl/blob/806e8a852c90af3de29353d9d6ab13a2f2f637b8/src/pn_expressions/mode_weights.jl#L4-L42">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../derived_variables/">¬´ Derived variables</a><a class="docs-footer-nextpage" href="../dynamics/">Dynamics ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.4 on <span class="colophon-date" title="Friday 23 May 2025 05:03">Friday 23 May 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
