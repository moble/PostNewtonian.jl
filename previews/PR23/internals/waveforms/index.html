<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Waveforms ¬∑ PostNewtonian.jl</title><meta name="title" content="Waveforms ¬∑ PostNewtonian.jl"/><meta property="og:title" content="Waveforms ¬∑ PostNewtonian.jl"/><meta property="twitter:title" content="Waveforms ¬∑ PostNewtonian.jl"/><meta name="description" content="Documentation for PostNewtonian.jl."/><meta property="og:description" content="Documentation for PostNewtonian.jl."/><meta property="twitter:description" content="Documentation for PostNewtonian.jl."/><meta property="og:url" content="https://moble.github.io/PostNewtonian.jl/stable/internals/waveforms/"/><meta property="twitter:url" content="https://moble.github.io/PostNewtonian.jl/stable/internals/waveforms/"/><link rel="canonical" href="https://moble.github.io/PostNewtonian.jl/stable/internals/waveforms/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.048/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.4/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PostNewtonian.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs (Ctrl + /)"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><span class="tocitem">Interface</span><ul><li><a class="tocitem" href="../../interface/standard_interface/">Standard interface</a></li><li><a class="tocitem" href="../../interface/symbolics/">Symbolic manipulations</a></li><li><a class="tocitem" href="../../interface/differentiation/">Automatic differentiation</a></li><li><a class="tocitem" href="../../interface/assorted_binaries/">Assorted binaries</a></li><li><a class="tocitem" href="../../interface/python/">Python</a></li><li><a class="tocitem" href="../../interface/gwframes/">GWFrames</a></li></ul></li><li><span class="tocitem">Internals</span><ul><li><a class="tocitem" href="../code_structure/">Code structure</a></li><li><a class="tocitem" href="../systems/">PN systems</a></li><li><a class="tocitem" href="../fundamental_variables/">Fundamental variables</a></li><li><a class="tocitem" href="../derived_variables/">Derived variables</a></li><li><a class="tocitem" href="../pn_expressions/">PN expressions</a></li><li><a class="tocitem" href="../dynamics/">Dynamics</a></li><li class="is-active"><a class="tocitem" href>Waveforms</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#In-place-evaluation-of-waveforms"><span>In-place evaluation of waveforms</span></a></li></ul></li><li><a class="tocitem" href="../utilities/">Utilities</a></li></ul></li><li><a class="tocitem" href="../../adding_terms/">Adding terms</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><div class="docs-left"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Internals</a></li><li class="is-active"><a href>Waveforms</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Waveforms</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/moble/PostNewtonian.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/moble/PostNewtonian.jl/blob/main/docs/src/internals/waveforms.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a></div></header><article class="content" id="documenter-page"><h1 id="Computing-the-waveform"><a class="docs-heading-anchor" href="#Computing-the-waveform">Computing the waveform</a><a id="Computing-the-waveform-1"></a><a class="docs-heading-anchor-permalink" href="#Computing-the-waveform" title="Permalink"></a></h1><p>Once you have used <a href="../dynamics/#PostNewtonian.orbital_evolution"><code>orbital_evolution</code></a> to compute the inspiral, and selected the time steps on which you want the waveform, you can compute the waveform with one of the following functions.</p><div class="admonition is-danger"><header class="admonition-header">Danger</header><div class="admonition-body"><p>Remember that, by default, <a href="../dynamics/#PostNewtonian.orbital_evolution"><code>orbital_evolution</code></a> will return the solution at whatever time steps the ODE integrator chose, which are almost certainly too far apart to satisfy the Nyquist limit relevant for waveforms. You can use the <code>saves_per_orbit</code> argument to that function with a value of at least <code>2‚Ñì‚Çò‚Çê‚Çì</code> (where <code>‚Ñì‚Çò‚Çê‚Çì</code> is the argument to one of the functions below) to barely satisfy the Nyquist limit.  I usually use <code>4‚Ñì‚Çò‚Çê‚Çì</code> for a little extra safety factor.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="PostNewtonian.coorbital_waveform" href="#PostNewtonian.coorbital_waveform"><code>PostNewtonian.coorbital_waveform</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">coorbital_waveform(inspiral; [‚Ñì‚Çò·µ¢‚Çô=2], [‚Ñì‚Çò‚Çê‚Çì=8], [PNOrder])</code></pre><p>Evaluate the post-Newtonian waveform mode weights in the co-orbital frame for the given <code>inspiral</code> output by <a href="../dynamics/#PostNewtonian.orbital_evolution"><code>orbital_evolution</code></a>.</p><p>The <code>PNOrder</code> defaults to the one used to compute <code>inspiral</code>, but may be changed by passing the keyword argument.</p><p>See also <a href="#PostNewtonian.inertial_waveform"><code>inertial_waveform</code></a> for the waveform in the inertial frame.</p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>If you need this waveform at a different set of times <code>t‚Ä≤</code> than is currently present in <code>inspiral.t</code>, you should use the built-in interpolation capabilities of <code>inspiral</code> <em>first</em>, as in <code>inspiral‚Ä≤ = inspiral(t‚Ä≤)</code>, rather than interpolating the results of this function.  Or, perhaps better yet, you could select the times when calling <code>orbital_evolution</code> by using the <code>saveat</code> or <code>saves_per_orbit</code> keyword argument to that function.  These approaches will be more accurate, faster, and require less memory than interpolating the result of this function.</p></div></div><p>The mode weights are given starting at <code>‚Ñì‚Çò·µ¢‚Çô</code> (which must satisfy <code>0 ‚â§ ‚Ñì‚Çò·µ¢‚Çô ‚â§ 2</code>) and extending through <code>‚Ñì‚Çò‚Çê‚Çì</code>.  The waveform is returned as a 2-dimensional <code>Array</code>, in which the first index varies over the mode index from <code>(‚Ñì, m) = (‚Ñì‚Çò·µ¢‚Çô, -‚Ñì‚Çò·µ¢‚Çô)</code> to <code>(‚Ñì, m) = (‚Ñì‚Çò‚Çê‚Çì, ‚Ñì‚Çò‚Çê‚Çì)</code>, with <code>m</code> varying most rapidly, and the second index varying over the time steps.</p><p>By default, the waveform is returned in the co-orbital frame ‚Äî which is somewhat like the co-rotating frame.  In particular, the modes of non-precessing systems vary slowly, over inspiral timescales; modes of precessing systems still vary on orbital timescales, though even this variation could be factored out.  If <code>inertial=true</code> is passed, the waveform is instead transformed to the inertial frame, resulting in the oscillatory behavior we usually expect from a waveform.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/PostNewtonian.jl/blob/6c74e404b6a9c474cfd75f37c38f17e1a17b06be/src/waveforms.jl#L60-L91">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PostNewtonian.inertial_waveform" href="#PostNewtonian.inertial_waveform"><code>PostNewtonian.inertial_waveform</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">inertial_waveform(inspiral, [‚Ñì‚Çò·µ¢‚Çô=2], [‚Ñì‚Çò‚Çê‚Çì=8], [PNOrder])</code></pre><p>Evaluate the post-Newtonian waveform mode weights in the inertial frame for the given <code>inspiral</code> output by <a href="../dynamics/#PostNewtonian.orbital_evolution"><code>orbital_evolution</code></a>.</p><p>The inertial frame is the one in which inertial observers are found, so this waveform is more like one that actual observers would detect.  This function transforms the waveform from the co-orbital frame ‚Äî which is the one in which PN expressions are provided.</p><p>See <a href="#PostNewtonian.coorbital_waveform"><code>coorbital_waveform</code></a> for details about the other arguments.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/PostNewtonian.jl/blob/6c74e404b6a9c474cfd75f37c38f17e1a17b06be/src/waveforms.jl#L156-L167">source</a></section></article><h1 id="In-place-evaluation-of-waveforms"><a class="docs-heading-anchor" href="#In-place-evaluation-of-waveforms">In-place evaluation of waveforms</a><a id="In-place-evaluation-of-waveforms-1"></a><a class="docs-heading-anchor-permalink" href="#In-place-evaluation-of-waveforms" title="Permalink"></a></h1><p>This is likely to be an uncommon scenario, but if you happen to need to evaluate the waveform repeatedly on the same set (or at least same number) of time steps and same range of <span>$\ell$</span> values, then you can pre-allocate the storage needed in this process, and re-use that storage.  To do so, pre-allocate using either <a href="#PostNewtonian.coorbital_waveform_computation_storage"><code>coorbital_waveform_computation_storage</code></a> or <a href="#PostNewtonian.inertial_waveform_computation_storage"><code>inertial_waveform_computation_storage</code></a>, and then pass the result as the first argument to either <a href="#PostNewtonian.coorbital_waveform!"><code>coorbital_waveform!</code></a> or <a href="#PostNewtonian.inertial_waveform!"><code>inertial_waveform!</code></a>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The <code>h</code> array returned by either <code>coorbital_waveform!</code> or <code>inertial_waveform!</code> is part of the pre-allocated storage.  You need to use its values <em>before</em> you call either of those functions again, or those values will just be overwritten.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="PostNewtonian.coorbital_waveform_computation_storage" href="#PostNewtonian.coorbital_waveform_computation_storage"><code>PostNewtonian.coorbital_waveform_computation_storage</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">coorbital_waveform_computation_storage(inspiral; [‚Ñì‚Çò·µ¢‚Çô=2], [‚Ñì‚Çò‚Çê‚Çì=8], [PNOrder])</code></pre><p>Construct storage needed to compute waveforms in the co-orbital frame without allocations.</p><p>This returns the storage for the waveforms themselves and <code>PNSystem</code> used as temporary storage.  The returned quantity can just be passed as the first argument to <a href="#PostNewtonian.coorbital_waveform!"><code>coorbital_waveform!</code></a> without being unpacked.</p><p>The meaning of the arguments is the same as in <a href="#PostNewtonian.coorbital_waveform"><code>coorbital_waveform</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/PostNewtonian.jl/blob/6c74e404b6a9c474cfd75f37c38f17e1a17b06be/src/waveforms.jl#L7-L17">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PostNewtonian.inertial_waveform_computation_storage" href="#PostNewtonian.inertial_waveform_computation_storage"><code>PostNewtonian.inertial_waveform_computation_storage</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">inertial_waveform_computation_storage(inspiral; [‚Ñì‚Çò·µ¢‚Çô=2], [‚Ñì‚Çò‚Çê‚Çì=8], [PNOrder])</code></pre><p>Construct storage needed to compute waveforms in the inertial frame without allocations.</p><p>This returns the storage for the waveforms themselves, storage used for computing the Wigner ùîá matrices, and for &quot;in-place&quot; multiplication.  The returned quantity can just be passed as the first argument to <a href="#PostNewtonian.inertial_waveform!"><code>inertial_waveform!</code></a> without being unpacked.</p><p>The meaning of the arguments is the same as in <a href="#PostNewtonian.inertial_waveform"><code>inertial_waveform</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/PostNewtonian.jl/blob/6c74e404b6a9c474cfd75f37c38f17e1a17b06be/src/waveforms.jl#L104-L114">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PostNewtonian.coorbital_waveform!" href="#PostNewtonian.coorbital_waveform!"><code>PostNewtonian.coorbital_waveform!</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">coorbital_waveform!(storage, inspiral; [‚Ñì‚Çò·µ¢‚Çô=2], [‚Ñì‚Çò‚Çê‚Çì=8], [PNOrder])</code></pre><p>Evaluate the post-Newtonian waveform mode weights in the co-orbital frame for the given <code>inspiral</code> output by <a href="../dynamics/#PostNewtonian.orbital_evolution"><code>orbital_evolution</code></a>, using pre-allocated storage.</p><p>The storage is assumed to be the object returned from <a href="#PostNewtonian.coorbital_waveform_computation_storage"><code>coorbital_waveform_computation_storage</code></a>.  Other arguments are the same as in <a href="#PostNewtonian.coorbital_waveform"><code>coorbital_waveform</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/PostNewtonian.jl/blob/6c74e404b6a9c474cfd75f37c38f17e1a17b06be/src/waveforms.jl#L36-L45">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PostNewtonian.inertial_waveform!" href="#PostNewtonian.inertial_waveform!"><code>PostNewtonian.inertial_waveform!</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">inertial_waveform!(storage, inspiral; [‚Ñì‚Çò·µ¢‚Çô=2], [‚Ñì‚Çò‚Çê‚Çì=8], [PNOrder])</code></pre><p>Evaluate the post-Newtonian waveform mode weights in the inertial frame for the given <code>inspiral</code> output by <a href="../dynamics/#PostNewtonian.orbital_evolution"><code>orbital_evolution</code></a>, using pre-allocated storage.</p><p>The storage is assumed to be the object returned from <a href="#PostNewtonian.inertial_waveform_computation_storage"><code>inertial_waveform_computation_storage</code></a>.  Other arguments are the same as in <a href="#PostNewtonian.inertial_waveform"><code>inertial_waveform</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/PostNewtonian.jl/blob/6c74e404b6a9c474cfd75f37c38f17e1a17b06be/src/waveforms.jl#L124-L133">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../dynamics/">¬´ Dynamics</a><a class="docs-footer-nextpage" href="../utilities/">Utilities ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.28.0-DEV on <span class="colophon-date" title="Tuesday 4 April 2023 00:23">Tuesday 4 April 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
