<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Units ¬∑ PostNewtonian.jl</title><meta name="title" content="Units ¬∑ PostNewtonian.jl"/><meta property="og:title" content="Units ¬∑ PostNewtonian.jl"/><meta property="twitter:title" content="Units ¬∑ PostNewtonian.jl"/><meta name="description" content="Documentation for PostNewtonian.jl."/><meta property="og:description" content="Documentation for PostNewtonian.jl."/><meta property="twitter:description" content="Documentation for PostNewtonian.jl."/><meta property="og:url" content="https://moble.github.io/PostNewtonian.jl/stable/interface/units/"/><meta property="twitter:url" content="https://moble.github.io/PostNewtonian.jl/stable/interface/units/"/><link rel="canonical" href="https://moble.github.io/PostNewtonian.jl/stable/interface/units/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.048/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.4/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PostNewtonian.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs (Ctrl + /)"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><span class="tocitem">Interface</span><ul><li><a class="tocitem" href="../high-level/">High-level interface</a></li><li class="is-active"><a class="tocitem" href>Units</a><ul class="internal"><li><a class="tocitem" href="#Example-1:-Scale-dependence"><span>Example 1: Scale dependence</span></a></li><li><a class="tocitem" href="#Units-example-2"><span>Example 2: Astrophysical units</span></a></li></ul></li><li><a class="tocitem" href="../symbolics/">Symbolic manipulations</a></li><li><a class="tocitem" href="../differentiation/">Automatic differentiation</a></li><li><a class="tocitem" href="../assorted_binaries/">Assorted binaries</a></li><li><a class="tocitem" href="../python/">Python</a></li><li><a class="tocitem" href="../gwframes/">GWFrames</a></li></ul></li><li><span class="tocitem">Internals</span><ul><li><a class="tocitem" href="../../internals/code_structure/">Code structure</a></li><li><a class="tocitem" href="../../internals/systems/">PN systems</a></li><li><a class="tocitem" href="../../internals/fundamental_variables/">Fundamental variables</a></li><li><a class="tocitem" href="../../internals/derived_variables/">Derived variables</a></li><li><a class="tocitem" href="../../internals/pn_expressions/">PN expressions</a></li><li><a class="tocitem" href="../../internals/dynamics/">Dynamics</a></li><li><a class="tocitem" href="../../internals/waveforms/">Waveforms</a></li><li><a class="tocitem" href="../../internals/utilities/">Utilities</a></li></ul></li><li><a class="tocitem" href="../../adding_terms/">Adding terms</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><div class="docs-left"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Interface</a></li><li class="is-active"><a href>Units</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Units</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/moble/PostNewtonian.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/moble/PostNewtonian.jl/blob/main/docs/src/interface/units.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="A-note-about-units"><a class="docs-heading-anchor" href="#A-note-about-units">A note about units</a><a id="A-note-about-units-1"></a><a class="docs-heading-anchor-permalink" href="#A-note-about-units" title="Permalink"></a></h1><div class="admonition is-info"><header class="admonition-header">TL;DR:</header><div class="admonition-body"><p>This package uses geometric units with <span>$G=c=1$</span>.  Units are essentially determined by the values you input.  Masses and frequencies in particular must have inverse units.  For example, if frequency is measured in Hertz, mass should be measured in seconds.  The common relativist&#39;s convention of measuring in units of &quot;total mass&quot; (whatever that means to you) is also perfectly fine.</p><p>Output time is in units of the total mass; to get the time in seconds, multiply by the total mass as measured in seconds.  Waveforms are output as the asymptotic quantity <span>$rh/M$</span>; to get an observable strain, multiply by the total mass and divide by the distance to the source.</p><p>You may want to skip to <a href="#Units-example-2">Example 2</a> for a complete example using astrophysical units.</p></div></div><p>The units of measurement used in this package are implicitly established by the input.  Specifically, the arguments <code>M‚ÇÅ</code>, <code>M‚ÇÇ</code>, and <code>Œ©·µ¢</code> in the call</p><pre><code class="language-julia hljs">inspiral = orbital_evolution(M‚ÇÅ, M‚ÇÇ, œá‚Éó‚ÇÅ, œá‚Éó‚ÇÇ, Œ©·µ¢)</code></pre><p>are inherently dimensionful, and the units are effectively determined by the values entered.  For example, if we enter <code>0.4</code> as <code>M‚ÇÅ</code>, we have established the units as ‚Äî quite simply ‚Äî those units in which <code>M‚ÇÅ</code> has the value <code>0.4</code>.  The only real requirement on the units of the input arguments is that they must be consistent.  In particular, the quantity <code>(M‚ÇÅ+M‚ÇÇ)*Œ©·µ¢</code> should be dimensionless.</p><p>It must also be noted that this package uses geometric units where <span>$G=c=1$</span>; in fact, <span>$G$</span> and <span>$c$</span> never appear in the code at all.  This means that you must input values in geometric units, and interpret the output as being in geometric units.  This does not completely constrain the units, however.  There is still a freedom to scale the units however you wish.  For example, it is most common to describe all quantities in units of some mass <span>$M$</span> ‚Äî such as the sum of the input masses <code>M‚ÇÅ+M‚ÇÇ</code> or the Solar mass <span>$M_\odot$</span>.  The input arguments would then <em>all</em> be given in units of that mass, or more likely some product of that mass with <span>$G$</span> and <span>$c$</span>.</p><p>The complete set of (required or optional) dimensionful arguments to <code>orbital_evolution</code> is</p><pre><code class="language-julia hljs">M‚ÇÅ, M‚ÇÇ, Œ©·µ¢, Œõ‚ÇÅ, Œõ‚ÇÇ, Œ©‚ÇÅ, Œ©‚Çë, abstol, saveat</code></pre><p>If we scale the values by some <code>œÉ</code>, then to maintain the same physical meaning we should transform all the arguments as</p><pre><code class="nohighlight hljs">M‚ÇÅ ‚Ü¶ M‚ÇÅ * œÉ
M‚ÇÇ ‚Ü¶ M‚ÇÇ * œÉ
Œ©·µ¢ ‚Ü¶ Œ©·µ¢ / œÉ
Œõ‚ÇÅ ‚Ü¶ Œõ‚ÇÅ
Œõ‚ÇÇ ‚Ü¶ Œõ‚ÇÇ
Œ©‚ÇÅ ‚Ü¶ Œ©‚ÇÅ / œÉ
Œ©‚Çë ‚Ü¶ Œ©‚Çë / œÉ
abstol ‚Ü¶ [abstol[1:2] * œÉ; abstol[3:end]]
saveat ‚Ü¶ saveat * œÉ</code></pre><p>Note that the scaling happens automatically for default values of the parameters; you would only need to rescale them if you were actually setting them.</p><p>When the scaled arguments are provided to <code>orbital_evolution</code>, the resulting <code>inspiral</code> is affected as</p><pre><code class="language-julia hljs">inspiral.t ‚Ü¶ inspiral.t * œÉ
inspiral[:M‚ÇÅ] ‚Ü¶ inspiral[:M‚ÇÅ] * œÉ
inspiral[:M‚ÇÇ] ‚Ü¶ inspiral[:M‚ÇÇ] * œÉ</code></pre><p>All other evolved variables are dimensionless, and so are unaffected by the scaling.  In particular, if the initial conditions are entered with values of <code>M‚ÇÅ</code> and <code>M‚ÇÇ</code> in their desired final units, no change needs to be made.  On the other hand, if the values are entered so that <code>M‚ÇÅ+M‚ÇÇ=1</code>, we can rescale any BBH system to any desired total mass <code>M‚Çú‚Çí‚Çú</code> using</p><pre><code class="language-julia hljs">inspiral.t ‚Ü¶ inspiral.t * M‚Çú‚Çí‚Çú * G / c^3</code></pre><p>Furthermore, if <code>M‚ÇÅ</code> and <code>M‚ÇÇ</code> represent the <em>source-frame</em> mass, and we need to apply a cosmological redshift <code>z</code>, we simply apply</p><pre><code class="language-julia hljs">inspiral.t ‚Ü¶ inspiral.t * (1+z)</code></pre><p>The waveform <span>$H$</span> returned by either <a href="../../internals/waveforms/#PostNewtonian.coorbital_waveform"><code>coorbital_waveform</code></a> or <a href="../../internals/waveforms/#PostNewtonian.inertial_waveform"><code>inertial_waveform</code></a> is the rescaled asymptotic limit of the strain.  The observable strain is</p><p class="math-container">\[h \approx H\, \frac{M}{r}\, \frac{G}{c^2}
\qquad \mathrm{or} \qquad
h \approx H\, \frac{M_z}{d_\mathrm{L}}\, \frac{G}{c^2}.\]</p><p>(The equality is only approximate because we assume that terms in <span>$1/r^2$</span> can be ignored, which is almost certainly true of any detection in the foreseeable future.)  Here, <span>$r$</span> is the radius of the observer in asymptotically Minkowski coordinates centered on the source and <span>$M$</span> is the total mass of the binary; alternatively, <span>$M_z=M(1+z)$</span> is the redshifted mass and <span>$d_\mathrm{L}$</span> is the luminosity distance between the source and observer.  For more complete description, see <a href="../../internals/waveforms/#Computing-the-waveform">here</a>.</p><h2 id="Example-1:-Scale-dependence"><a class="docs-heading-anchor" href="#Example-1:-Scale-dependence">Example 1: Scale dependence</a><a id="Example-1:-Scale-dependence-1"></a><a class="docs-heading-anchor-permalink" href="#Example-1:-Scale-dependence" title="Permalink"></a></h2><p>It&#39;s important to check that the claims above are actually true.  Here, we put them to the test with a very large scale factor.</p><pre><code class="language-julia hljs">œÉ = 10^10  # Scale factor

M‚ÇÅ = 0.4
M‚ÇÇ = 0.6
œá‚Éó‚ÇÅ = [0.0, 0.5, 0.8]
œá‚Éó‚ÇÇ = [0.8, 0.0, 0.5]
Œ©·µ¢ = 0.01
Œ©‚ÇÅ = 3Œ©·µ¢/4
Œ©‚Çë = 0.9
dt = 5

inspiral1 = orbital_evolution(M‚ÇÅ, M‚ÇÇ, œá‚Éó‚ÇÅ, œá‚Éó‚ÇÇ, Œ©·µ¢, Œ©‚ÇÅ=Œ©‚ÇÅ, Œ©‚Çë=Œ©‚Çë, saveat=dt)
inspiral2 = orbital_evolution(M‚ÇÅ*œÉ, M‚ÇÇ*œÉ, œá‚Éó‚ÇÅ, œá‚Éó‚ÇÇ, Œ©·µ¢/œÉ, Œ©‚ÇÅ=Œ©‚ÇÅ/œÉ, Œ©‚Çë=Œ©‚Çë/œÉ, saveat=dt*œÉ)

plot(inspiral1.t, inspiral1[:v], label=&quot;Original&quot;)
plot!(inspiral2.t/œÉ, inspiral2[:v], label=&quot;Scaled&quot;, linewidth=4, ls=:dot)
plot!(xlabel=&quot;Time&quot;, ylabel=&quot;PN parameter ùë£&quot;)

# Check that the evolved `v` parameters are nearly equal (when interpolating
# the second to *exactly* the same times as the first)
inspiral1[:v] ‚âà inspiral2(inspiral1.t*œÉ, idxs=:v)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><iframe src="../units1.html" style="height:500px;width:100%;"></iframe><p>The fact that these curves are on top of each other, and the final expression returned <code>true</code> shows that this system does indeed depend on scale as suggested above.</p><h2 id="Units-example-2"><a class="docs-heading-anchor" href="#Units-example-2">Example 2: Astrophysical units</a><a id="Units-example-2-1"></a><a class="docs-heading-anchor-permalink" href="#Units-example-2" title="Permalink"></a></h2><p>Suppose we want to construct a system consistent with <a href="https://arxiv.org/abs/1606.01210">GW150914</a>, having source-frame masses <span>$35.6\,M_\odot$</span> and <span>$30.0\,M_\odot$</span>, as it would be observed from a distance of <span>$440\,\mathrm{Mpc}$</span> with an initial frequency in the dominant <span>$(\ell,m)=(2,\pm 2)$</span> modes of <span>$f_i \approx 20\,\mathrm{Hz}$</span>.</p><p>Because the masses and frequencies must be in inverse units, we arbitrarily choose to measure frequencies in their natural unit of Hertz, and therefore masses are measured in seconds ‚Äî multiplying the masses by <span>$G/c^3$</span> for geometric units.  The distance to the source <span>$d_\mathrm{L}$</span> will also be converted to seconds by dividing by <span>$c$</span>, so that we can simply multiply the waveform by <span>$M_z/d_\mathrm{L}$</span> to get the observed strain.</p><p>The frequency <span>$f_i$</span> is the observed initial frequency of the <span>$(2,2)$</span> mode. We will need the corresponding angular orbital frequency in the frame.  Recall that, by definition of redshift <span>$z$</span>, we have</p><p class="math-container">\[\frac{f_{\mathrm{source}}} {f_{\mathrm{observer}}} = 1+z
\qquad
\text{and}
\qquad
\frac{\Delta t_{\mathrm{observer}}}{\Delta t_{\mathrm{source}}} = 1+z.\]</p><p>Thus, the initial <em>source-frame orbital angular frequency</em> <span>$\Omega_i$</span> is related to the <em>observer-frame <span>$(2,2)$</span> temporal frequency</em> <span>$f_i$</span> by<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup></p><p class="math-container">\[%\Omega_i = 2\pi f_{\mathrm{source}}^{(2,2)} / 2 \qquad f_i = f_{\mathrm{observer}}^{(2,2)}
%\qquad
%\frac{f_{\mathrm{source}}^{(2,2)}} {f_{\mathrm{observer}}^{(2,2)}} = 
%\frac{\Omega_i/\pi} {f_i} = 1+z
%\qquad
\Omega_i = \pi\, f_i\, (1+z).\]</p><pre><code class="language-julia hljs">using Quaternionic
using SphericalFunctions
using PostNewtonian
using Plots

# Useful astronomical constants
c = float(299_792_458)   # meters/second
GM‚Çõ·µ§‚Çô = 1.32712440041e20  # meters¬≥/second¬≤
au = float(149_597_870_700)  # meters
pc = 1au / (œÄ / 648_000)  # meters
Mpc = 1_000_000pc  # meters

# Approximate maximum a posteriori spins (via SXS:BBH:0308)
œá‚Éó‚ÇÅ = [0.0, 0.0, 0.3224]
œá‚Éó‚ÇÇ = [0.2663, 0.2134, -0.5761]

# Parameters of this system (arXiv:1606.01210)
M‚ÇÅ = 35.6GM‚Çõ·µ§‚Çô / c^3  # seconds
M‚ÇÇ = 30.0GM‚Çõ·µ§‚Çô / c^3  # seconds
dL = 440Mpc / c  # seconds
z = 0.094
f·µ¢ = 20  # Hertz
Œît‚Çí = 1/2048  # seconds

# Conversions
Mz = (M‚ÇÅ+M‚ÇÇ) * (1+z)  # seconds
Œ©·µ¢ = œÄ * f·µ¢ * (1+z)  # Hertz
Œît‚Çõ = Œît‚Çí / (1+z)  # seconds

# Evaluate waveform and convert to observer&#39;s frame and units
inspiral = orbital_evolution(M‚ÇÅ, M‚ÇÇ, œá‚Éó‚ÇÅ, œá‚Éó‚ÇÇ, Œ©·µ¢, saveat=Œît‚Çõ)
t‚Çí = (1+z) * inspiral.t
H‚Çó‚Çò = inertial_waveform(inspiral)
h‚Çó‚Çò = H‚Çó‚Çò * Mz / dL

# Evaluate waveform at a point; see Scri.jl for simpler methods
R = Quaternionic.from_spherical_coordinates(2.856, 0.0)
‚Çã‚ÇÇY‚Çó‚Çò = SphericalFunctions.‚Çõùêò(-2, 8, Float64, [R])[1, :]
h = (‚Çã‚ÇÇY‚Çó‚Çò&#39; * h‚Çó‚Çò)[1,:]

# Plot the results
plot(t‚Çí, real.(h), label=&quot;‚Ñé‚Çä&quot;)
plot!(t‚Çí, -imag.(h), label=&quot;‚Ñé‚Çì&quot;)
plot!(xlabel=&quot;Time (seconds)&quot;, ylabel=&quot;Strain (dimensionless)&quot;, ylim=(-1.5e-21,1.5e-21))
plot!(title=&quot;Observer-frame waveform&quot;, legend=(0.205, 0.9))</code></pre><iframe src="../units2.html" style="height:500px;width:100%;"></iframe><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>Here, we have approximated the frequency of the <span>$(\ell,m)=(2,\pm 2)$</span> modes as being twice the orbital frequency.  In the post-Newtonian approximation, waveform mode <span>$H_{\ell,m}$</span> is frequently written as <span>$A_{\ell,m}\, \exp[-i\, m\, \Phi]$</span>, where <span>$\Phi$</span> is the orbital phase that varies in time with <span>$d\Phi/dt = \Omega$</span>.  Just looking at the exponential, we might expect the frequency of <span>$H_{\ell,m}$</span> to be <span>$m\, \Omega$</span>.  However, the &quot;amplitude&quot; term <span>$A_{\ell,m}$</span> is not an amplitude in the usual sense; it is actually complex, with a slowly varying phase. This means that the frequency of <span>$H_{\ell,m}$</span> is not precisely <span>$m\, \Omega$</span> ‚Äî though this is a reasonable approximation for systems with reasonably low frequency.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../high-level/">¬´ High-level interface</a><a class="docs-footer-nextpage" href="../symbolics/">Symbolic manipulations ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.28.0-DEV on <span class="colophon-date" title="Tuesday 13 June 2023 04:28">Tuesday 13 June 2023</span>. Using Julia version 1.9.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
