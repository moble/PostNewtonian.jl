<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home ¬∑ PostNewtonian.jl</title><script data-outdated-warner src="assets/warner.js"></script><link rel="canonical" href="https://moble.github.io/PostNewtonian.jl/stable/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>PostNewtonian.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Integrating-inspiral-dynamics"><span>Integrating inspiral dynamics</span></a></li><li><a class="tocitem" href="#Computing-mode-weights-from-the-inspiral-data"><span>Computing mode weights from the inspiral data</span></a></li><li><a class="tocitem" href="#Detecting-up-down-instability"><span>Detecting up-down instability</span></a></li><li><a class="tocitem" href="#Index-of-all-functions"><span>Index of all functions</span></a></li></ul></li><li><a class="tocitem" href="pn_expressions/">PN expressions</a></li><li><a class="tocitem" href="termination_criteria/">Termination criteria</a></li><li><a class="tocitem" href="utilities/">Utilities</a></li><li><a class="tocitem" href="gwframes/">GWFrames</a></li><li><a class="tocitem" href="python/">Calling from Python</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/moble/PostNewtonian.jl/blob/main/docs/src/index.md#" title="Edit on GitHub"><span class="docs-icon fab">ÔÇõ</span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="PostNewtonian"><a class="docs-heading-anchor" href="#PostNewtonian">PostNewtonian</a><a id="PostNewtonian-1"></a><a class="docs-heading-anchor-permalink" href="#PostNewtonian" title="Permalink"></a></h1><p>This package computes orbital dynamics of and waveforms from binary black-hole systems, in the <a href="https://en.wikipedia.org/wiki/Post-Newtonian_expansion">post-Newtonian approximation</a>. Currently, there is no support for eccentric systems, but general precessing quasicircular systems are supported.</p><h2 id="Integrating-inspiral-dynamics"><a class="docs-heading-anchor" href="#Integrating-inspiral-dynamics">Integrating inspiral dynamics</a><a id="Integrating-inspiral-dynamics-1"></a><a class="docs-heading-anchor-permalink" href="#Integrating-inspiral-dynamics" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="PostNewtonian.inspiral" href="#PostNewtonian.inspiral"><code>PostNewtonian.inspiral</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">inspiral(M‚ÇÅ, M‚ÇÇ, œá‚Éó‚ÇÅ, œá‚Éó‚ÇÇ, Œ©·µ¢; kwargs...)</code></pre><p>Integrate the orbital dynamics of an inspiraling non-eccentric compact binary.</p><p><strong>Required arguments</strong></p><ul><li><code>M‚ÇÅ</code>: Initial mass of black hole 1</li><li><code>M‚ÇÇ</code>: Initial mass of black hole 2</li><li><code>œá‚Éó‚ÇÅ</code>: Initial dimensionless spin of black hole 1, S‚Éó‚ÇÅ/M‚ÇÅ¬≤</li><li><code>œá‚Éó‚ÇÇ</code>: Initial dimensionless spin of black hole 2, S‚Éó‚ÇÇ/M‚ÇÇ¬≤</li><li><code>Œ©·µ¢</code>: Initial orbital angular velocity</li></ul><p>These parameters all describe the &quot;initial&quot; conditions.  See below for an explanation of the different meanings of &quot;initial&quot; and &quot;first&quot; in this context. Note that the masses change in time as a result of tidal heating ‚Äî though the changes are quite small throughout most of the inspiral.  The spins change direction due to precession, but also change in magnitude due to tidal heating. Therefore, the values passed here are only precisely as given <em>precisely at</em> the moment of the initial data corresponding to the frequency <code>Œ©·µ¢</code>.</p><p><strong>Keyword arguments</strong></p><ul><li><code>Œ©‚ÇÅ=Œ©·µ¢</code>: First angular velocity in output data (see next section).</li><li><code>Œ©‚Çë=1</code>: Final angular velocity at which to stop ODE integration.</li><li><code>R·µ¢=Rotor(true)</code>: Initial orientation of binary.</li><li><code>PNSys=TaylorT1</code>: Currently the only possibility.</li><li><code>PNOrder=7//2</code>: Not actually used currently.</li><li><code>check_up_down_instability=true</code>: Warn if the &quot;up-down instability&quot; (see below) is likely to affect this system.</li><li><code>time_stepper=AutoVern9(Rodas5())</code>: Choice of solver in OrdinaryDiffEq to integrate ODE.</li><li><code>abstol=eps(T)^(11//16)</code>: Absolute tolerance of ODE solver, where <code>T</code> is the common type to which all the positional arguments are promoted.  This is the tolerance on local error estimates, not necessarily the global error.</li><li><code>reltol=eps(T)^(11//16)</code>: Relative tolerance of ODE solver.  (As above.)</li><li><code>termination_criteria_forwards=nothing</code>: Callbacks to use for forwards-in-time evolution.  See below for discussion of the default value.</li><li><code>termination_criteria_backwards=nothing</code>: Callbacks to use for backwards-in-time evolution.  See below for discussion of the default value.</li><li><code>force_dtmin=true</code>: If <code>dt</code> decreases below the integrator&#39;s own minimum, and this is false, the integrator will immediately raise an error, before the termination criteria have the chance to exit gracefully.  Note that a true value here is critical if the <code>dtmin_terminator</code> callback is to have any effect.</li><li><code>quiet=false</code>: If set to <code>true</code>, informational messages about successful terminations of the ODE integrations (which occur when the target <span>$v$</span> is reached in either direction) will be silenced.  Warnings will still be issued when terminating for other reasons; if you wish to silence them too, you should do something like<pre><code class="language-julia hljs">using Logging
with_logger(SimpleLogger(Logging.Error)) do
    &lt;your code goes here&gt;
end</code></pre></li><li><code>integrate_orbital_phase=false</code>: If set to <code>true</code>, integrate the orbital phase <span>$Œ¶$</span> along with the rest of the system.  Note that this may slow the system down because the absolute value of <span>$Œ¶$</span> may grow to very large values, so that the <code>abstol</code> will strain to keep its evolution far more accurate than is really needed.  If this is a problem, you can loosen <code>abstol</code> and/or pass vectors of separate tolerances for each variable in the ODE system (see below).</li></ul><p>All remaining keyword arguments are passed to the <a href="https://github.com/SciML/DiffEqBase.jl/blob/8e6173029c630f6908252f3fc28a69c1f0eab456/src/solve.jl#L393"><code>solve</code> function</a> of <code>DiffEqBase</code>.  See that function&#39;s documentation for details, including useful keyword arguments.  The most likely important ones are</p><ul><li><code>saveat</code>: Denotes specific times to save the solution at, during the solving phase.</li><li><code>dt</code>: Sets the <em>initial</em> stepsize. Defaults to an automatic choice if the method is adaptive.</li><li><code>dtmax</code>: Maximum dt for adaptive timestepping.</li><li><code>dtmin</code>: Minimum dt for adaptive timestepping.</li></ul><p>Note that if you want the solution to be output with specifically spaced time steps, you <em>don&#39;t</em> want <code>dt</code>, which is just the initial suggestion for adaptive systems; you want to set <code>saveat</code> to the desired spacing.  [The <code>saveat</code> argument could be a vector of specific times at which to save, but because we don&#39;t know when the PN evolution ends, this probably isn&#39;t useful.]</p><p>Also note that <code>callback</code> can be used, and is combined with the callbacks generated by the <code>termination_criteria_*</code> arguments above.  See <a href="https://diffeq.sciml.ai/dev/features/callback_functions/">the documentation</a> for more details, but note that if you want to make your own callbacks, you will need to add <code>OrdinaryDiffEq</code> to your project ‚Äî or possibly even <code>DifferentialEquations</code> for some of the fancier built-in callbacks.</p><p><strong>ODE system</strong></p><p>The evolved variables, in order, are</p><ul><li><code>M‚ÇÅ</code>: Mass of black hole 1</li><li><code>M‚ÇÇ</code>: Mass of black hole 2</li><li><code>œá‚Éó‚ÇÅÀ£</code>: <span>$x$</span> component of dimensionless spin of black hole 1</li><li><code>œá‚Éó‚ÇÅ ∏</code>: <span>$y$</span> component...</li><li><code>œá‚Éó‚ÇÅ·∂ª</code>: <span>$z$</span> component...</li><li><code>œá‚Éó‚ÇÇÀ£</code>: <span>$x$</span> component of dimensionless spin of black hole 2</li><li><code>œá‚Éó‚ÇÇ ∏</code>: <span>$y$</span> component...</li><li><code>œá‚Éó‚ÇÇ·∂ª</code>: <span>$z$</span> component...</li><li><code>R ∑</code>: Scalar component of frame rotor</li><li><code>RÀ£</code>: <span>$x$</span> component...</li><li><code>R ∏</code>: <span>$y$</span> component...</li><li><code>R·∂ª</code>: <span>$z$</span> component...</li><li><code>v</code>: PN &quot;velocity&quot; parameter related to the total mass <span>$M$</span> and orbital angular velocity <span>$Œ©$</span> by <span>$v = (M Œ©)^{1/3}$</span></li><li><code>Œ¶</code>: Orbital phase given by integrating <span>$Œ©$</span> (optional; only appears if <code>integrate_orbital_phase</code> is <code>true</code>)</li></ul><p>The masses and spin magnitudes evolve according to <a href="pn_expressions/#PostNewtonian.tidal_heating-NTuple{13, Any}"><code>tidal_heating</code></a>. The spin directions evolve according to <a href="pn_expressions/#PostNewtonian.Œ©‚Éó·µ™‚ÇÅ-NTuple{13, Any}"><code>Œ©‚Éó·µ™‚ÇÅ</code></a> and <a href="pn_expressions/#PostNewtonian.Œ©‚Éó·µ™‚ÇÇ-NTuple{13, Any}"><code>Œ©‚Éó·µ™‚ÇÇ</code></a>.  The frame rotor <span>$R$</span> is given by integrating the angular velocity as described in <a href="https://arxiv.org/abs/1604.08139">Boyle (2016)</a>, while the angular velocity itself is given by <a href="pn_expressions/#PostNewtonian.Œ©‚Éó‚Çö-NTuple{13, Any}"><code>Œ©‚Éó‚Çö</code></a>.  And finally, the PN parameter <span>$v$</span> evolves according to something like</p><p class="math-container">\[\dot{v} = - \frac{\mathcal{F} + \dot{M}_1 + \dot{M}_2} {\mathcal{E}&#39;}\]</p><p>where <a href="pn_expressions/#PostNewtonian.ùìï-NTuple{13, Any}"><code>ùìï</code></a> is the flux of gravitational-wave energy out of the system and <a href="pn_expressions/#PostNewtonian.ùìî‚Ä≤-NTuple{13, Any}"><code>ùìî‚Ä≤</code></a> is the derivative of the binding energy with respect to <span>$v$</span>. For <code>&quot;TaylorT1&quot;</code>, the right-hand side of this equation is evaluated as given; for <code>&quot;TaylorT4&quot;</code>, the right-hand side is first expanded as a Taylor series in <span>$v$</span> and then truncated at some desired order; for <code>&quot;TaylorT5&quot;</code>, the <em>inverse</em> of the right-hand side is expanded as a Taylor series in <span>$v$</span>, truncated at some desired order, and then inverted to obtain an expression in terms of <span>$v$</span>.</p><p><strong>Returned solution</strong></p><p>The returned quantity is an <a href="https://diffeq.sciml.ai/dev/basics/solution/"><code>ODESolution</code></a> object, which has various features for extracting and interpolating the data.  We&#39;ll call this object <code>sol</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The solution comes with data at the time points the ODE integrator happened to step to.  However, it <em>also</em> comes with dense output (unless you manually turn it off when calling <code>inspiral</code>).  This means that you can interpolate the solution to any other set of time points you want simply by calling it as <code>sol(t)</code> for some vector of time points <code>t</code>.  The quantity returned by that will have the following features, just like the original solution.  Note that if you only want some of the data you can provide the optional keyword argument <code>idxs</code> to specify which of the elements described below you want to interpolate.  For example, if you only want to interpolate the values of <code>M‚ÇÅ</code> and <code>M‚ÇÇ</code>, you can use <code>sol(t, idxs=[1,2])</code>.</p></div></div><p>The field <code>sol.t</code> is the set of time points at which the solution is given.  To access the <code>i</code>th variable at time step <code>j</code>, use <code>sol[i, j]</code>.<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup> You can also use colons.  For example, <code>sol[:, j]</code> is a vector of all the data at time step <code>j</code>, and <code>sol[i, :]</code> is a vector of the <code>i</code>th variable at all times.</p><p><strong>Initial frequency vs. first frequency vs. end frequency</strong></p><p>Note the distinction between <code>Œ©·µ¢</code> (with subscript <code>i</code>) and <code>Œ©‚ÇÅ</code> (with subscript <code>1</code>).  The first, <code>Œ©·µ¢</code>, represents the angular velocity of the <em>initial condition</em> from which the ODE integrator will begin; the second, <code>Œ©‚ÇÅ</code>, represents the target angular velocity of the first element of the output data. That is, the ODE integration will run forwards in time from <code>Œ©·µ¢</code> to the merger, and then come back to <code>Œ©·µ¢</code> and run backwards in time to <code>Œ©‚ÇÅ</code>.  The output data will stitch these two together to be one continuous (forwards-in-time) data series.</p><p>For example, if you are trying to match to a numerical relativity (NR) simulation, you can read the masses and spins off of the NR data when the system is orbiting at angular velocity <code>Œ©·µ¢</code>.  Integrating the post-Newtonian (PN) solution forwards in time from this point will allow you to compare the PN and NR waveforms.  However, you may want to know what the waveform was at <em>earlier</em> times than are present in the NR data.  For this, you also have to integrate backwards in time.  We parametrise the point to which you integrate backwards with <code>Œ©‚ÇÅ</code>.  In either case, element <code>1</code> of the output solution will have frequency <code>Œ©‚ÇÅ</code> ‚Äî though by default it is equal to <code>Œ©·µ¢</code>.</p><p>Similarly, the optional argument <code>Œ©‚Çë=1</code> is the frequency of the <code>end</code> element of the solution ‚Äî that is Julia&#39;s notation for the last element.  Note that this is automatically reduced if necessary so that the corresponding PN parameter <span>$v$</span> is no greater than 1, which may be the case whenever the total mass is greater than 1.</p><p><strong>Up-down instability</strong></p><p>Be aware that the <a href="http://arxiv.org/abs/1506.09116">up-down instability</a> (where the more massive black hole has spin aligned with the orbital angular velocity, and the less massive has spin anti-aligned) can cause systems with nearly zero precession at the initial time to evolve into a highly precessing system either at earlier or later times.  This is a real physical result, rather than a numerical issue.  If you want to simulate a truly non-precessing system, you should explicitly set the in-place components of spin to precisely 0.  By default, we check for this condition, and will issue a warning if it is likely to be encountered for systems with low initial precession.  The function used to compute the unstable region is <a href="#PostNewtonian.up_down_instability"><code>up_down_instability</code></a>.</p><p><strong>Time-stepper algorithms</strong></p><p><code>Tsit5()</code> is a good default choice for time stepper when using <code>Float64</code> with medium-low tolerance.  If stiffness seems to be impacting the results, <code>AutoTsit5(Rosenbrock23())</code> will automatically switch when stiffness occurs. For tighter tolerances, especially when using <code>Double64</code>s, <code>Vern9()</code> or <code>AutoVern9(Rodas5())</code> are good choices.  For very loose tolerances, as when using <code>Float32</code>s, it might be better to use <code>OwrenZen3()</code>.</p><p><strong>Termination criteria</strong></p><p>The termination criteria are vital to efficiency of the integration and correctness of the solution.  The default values for forwards- and backwards-in-time evolution, respectively, are</p><pre><code class="language-julia hljs">CallbackSet(
    termination_forwards(v(Œ©=Œ©‚Çë, M=M‚ÇÅ+M‚ÇÇ)),
    dtmin_terminator(T),
    nonfinite_terminator()
)</code></pre><p>and</p><pre><code class="language-julia hljs">CallbackSet(
    termination_backwards(v(Œ©=Œ©‚ÇÅ, M=M‚ÇÅ+M‚ÇÇ)),
    dtmin_terminator(T),
    nonfinite_terminator()
)</code></pre><p>where <code>T</code> is the common float type of the input arguments.  If any additional termination criteria are needed, they could be added as additional elements of the <code>CallbackSet</code>s.  See the <a href="https://diffeq.sciml.ai/stable/features/callback_functions/">callback documentation</a> for details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/PostNewtonian.jl/blob/de98806308c30d93ab50f2b8c4a63453d670c5a4/src/inspiral.jl#L181-L421">source</a></section></article><h2 id="Computing-mode-weights-from-the-inspiral-data"><a class="docs-heading-anchor" href="#Computing-mode-weights-from-the-inspiral-data">Computing mode weights from the inspiral data</a><a id="Computing-mode-weights-from-the-inspiral-data-1"></a><a class="docs-heading-anchor-permalink" href="#Computing-mode-weights-from-the-inspiral-data" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="PostNewtonian.h!" href="#PostNewtonian.h!"><code>PostNewtonian.h!</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">h!(h, u; ‚Ñìmin=0)
h!(h, M‚ÇÅ, M‚ÇÇ, œá‚Éó‚ÇÅÀ£, œá‚Éó‚ÇÅ ∏, œá‚Éó‚ÇÅ·∂ª, œá‚Éó‚ÇÇÀ£, œá‚Éó‚ÇÇ ∏, œá‚Éó‚ÇÇ·∂ª, R ∑, RÀ£, R ∏, R·∂ª, v; ‚Ñìmin=0)
mode_weights!(h, u; ‚Ñìmin=0)
mode_weights!(h, M‚ÇÅ, M‚ÇÇ, œá‚Éó‚ÇÅÀ£, œá‚Éó‚ÇÅ ∏, œá‚Éó‚ÇÅ·∂ª, œá‚Éó‚ÇÇÀ£, œá‚Éó‚ÇÇ ∏, œá‚Éó‚ÇÇ·∂ª, R ∑, RÀ£, R ∏, R·∂ª, v; ‚Ñìmin=0)</code></pre><p>Compute mode weights of gravitational waves emitted by <code>pn</code> system, modifying <code>h</code> in place.</p><p>These modes are computed in the &quot;co-orbital&quot; frame, in which the larger object lies on the positive <span>$x$</span> axis, the smaller lies on the negative <span>$x$</span> axis, and the instantaneous angular velocity is in the positive <span>$z$</span> direction.</p><p>The modes are stored in <code>h</code> in order of increasing <span>$‚Ñì$</span> and increasing <span>$m$</span>, with <span>$m$</span> iterating fastest, all the way up to the highest available mode, <span>$(8,8)$</span>.</p><p>Because gravitational waves have spin weight -2, the <span>$(‚Ñì,m)=(0,0)$</span>, <span>$(1,-1)$</span>, <span>$(1,0)$</span>, and <span>$(1,1)$</span> modes are always 0.  By default, we assume that these modes are nonetheless included in <code>h</code>.  If that is not the case, set <code>‚Ñìmin</code> to the smallest <span>$‚Ñì$</span> value that should be present in the output data ‚Äî <code>‚Ñìmin=2</code> being the most reasonable alternative.</p><p>All non-spinning terms are taken from <a href="https://doi-org.proxy.library.cornell.edu/10.12942/lrr-2014-2">Blanchet (2014)</a>.  The 1PN spin-orbit term is from Eq. (3.22d) of <a href="https://link.aps.org/doi/10.1103/PhysRevD.52.821">Kidder (1995)</a>.  The 1.5PN spin-orbit term is from Eq. (3.22f) of Kidder (1995) and Eq. (F15b) of <a href="https://link.aps.org/doi/10.1103/PhysRevD.54.4813">Will and Wiseman (1996)</a>.  The 2PN spin-orbit term is from Eq. (4.13) of <a href="https://link.aps.org/doi/10.1103/PhysRevD.87.044009">Buonanno, Faye, Hinderer (2013)</a>, while the 2PN spin-spin term is from Eq. (4.15) of that reference.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/PostNewtonian.jl/blob/de98806308c30d93ab50f2b8c4a63453d670c5a4/src/mode_weights.jl#L5-L38">source</a></section></article><h2 id="Detecting-up-down-instability"><a class="docs-heading-anchor" href="#Detecting-up-down-instability">Detecting up-down instability</a><a id="Detecting-up-down-instability-1"></a><a class="docs-heading-anchor-permalink" href="#Detecting-up-down-instability" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="PostNewtonian.up_down_instability" href="#PostNewtonian.up_down_instability"><code>PostNewtonian.up_down_instability</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">up_down_instability(u)
up_down_instability(M‚ÇÅ, M‚ÇÇ, œá‚Éó‚ÇÅÀ£, œá‚Éó‚ÇÅ ∏, œá‚Éó‚ÇÅ·∂ª, œá‚Éó‚ÇÇÀ£, œá‚Éó‚ÇÇ ∏, œá‚Éó‚ÇÇ·∂ª, R ∑, RÀ£, R ∏, R·∂ª, v)</code></pre><p>Compute the range of frequencies over which the system is unstable to increasing precession.</p><p>The returned value is a pair of dimensionless frequencies giving the lower and upper frequencies between which we can expect instability.  If there is no instability expected, the returned pair is just (1,1).</p><p>For compact binaries in which the spins are either aligned or anti-aligned with the orbital angular velocity, we do not expect any precession effects ‚Äî simply by symmetry.  However, if the spin of the higher-mass object is aligned with the orbital angular velocity and the spin of the lower-mass object is anti-aligned, the binary is unstable to precession ‚Äî meaning that any minuscule misalignment can grow rapidly into significant precession.  This was first reported by <a href="http://arxiv.org/abs/1506.09116">Gerosa et al. (2015)</a>, and the range over which the system is unstable is given by Eq. (2) of that reference. We use the lowest-order approximation to convert binary separation to frequency.  The result is also &quot;clamped&quot; between 0 and 1, because sometimes the PN approximations involved break down and return unphysical values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/PostNewtonian.jl/blob/de98806308c30d93ab50f2b8c4a63453d670c5a4/src/up_down_instability.jl#L1-L24">source</a></section></article><h2 id="Index-of-all-functions"><a class="docs-heading-anchor" href="#Index-of-all-functions">Index of all functions</a><a id="Index-of-all-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Index-of-all-functions" title="Permalink"></a></h2><ul><li><a href="utilities/#PostNewtonian.log2"><code>PostNewtonian.log2</code></a></li><li><a href="utilities/#PostNewtonian.log3"><code>PostNewtonian.log3</code></a></li><li><a href="utilities/#PostNewtonian.log3halves"><code>PostNewtonian.log3halves</code></a></li><li><a href="utilities/#PostNewtonian.log5"><code>PostNewtonian.log5</code></a></li><li><a href="utilities/#PostNewtonian.log5halves"><code>PostNewtonian.log5halves</code></a></li><li><a href="utilities/#PostNewtonian.Œ∂3"><code>PostNewtonian.Œ∂3</code></a></li><li><a href="gwframes/#PostNewtonian.GWFrames.PNWaveform"><code>PostNewtonian.GWFrames.PNWaveform</code></a></li><li><a href="utilities/#PostNewtonian.S-NTuple{4, Any}"><code>PostNewtonian.S</code></a></li><li><a href="pn_expressions/#PostNewtonian.a‚Çó-NTuple{13, Any}"><code>PostNewtonian.a‚Çó</code></a></li><li><a href="utilities/#PostNewtonian.combine_solutions-Tuple{Any, Any}"><code>PostNewtonian.combine_solutions</code></a></li><li><a href="termination_criteria/#PostNewtonian.dtmin_terminator"><code>PostNewtonian.dtmin_terminator</code></a></li><li><a href="#PostNewtonian.h!"><code>PostNewtonian.h!</code></a></li><li><a href="#PostNewtonian.inspiral"><code>PostNewtonian.inspiral</code></a></li><li><a href="termination_criteria/#PostNewtonian.nonfinite_terminator"><code>PostNewtonian.nonfinite_terminator</code></a></li><li><a href="utilities/#PostNewtonian.nÃÇ"><code>PostNewtonian.nÃÇ</code></a></li><li><a href="utilities/#PostNewtonian.q-Tuple{Any, Any}"><code>PostNewtonian.q</code></a></li><li><a href="termination_criteria/#PostNewtonian.termination_backwards"><code>PostNewtonian.termination_backwards</code></a></li><li><a href="termination_criteria/#PostNewtonian.termination_forwards"><code>PostNewtonian.termination_forwards</code></a></li><li><a href="pn_expressions/#PostNewtonian.tidal_heating-NTuple{13, Any}"><code>PostNewtonian.tidal_heating</code></a></li><li><a href="#PostNewtonian.up_down_instability"><code>PostNewtonian.up_down_instability</code></a></li><li><a href="utilities/#PostNewtonian.v"><code>PostNewtonian.v</code></a></li><li><a href="utilities/#PostNewtonian.Œ£-NTuple{4, Any}"><code>PostNewtonian.Œ£</code></a></li><li><a href="utilities/#PostNewtonian.Œ©"><code>PostNewtonian.Œ©</code></a></li><li><a href="pn_expressions/#PostNewtonian.Œ©‚Éó·µ™-NTuple{6, Any}"><code>PostNewtonian.Œ©‚Éó·µ™</code></a></li><li><a href="pn_expressions/#PostNewtonian.Œ©‚Éó·µ™‚ÇÅ-NTuple{13, Any}"><code>PostNewtonian.Œ©‚Éó·µ™‚ÇÅ</code></a></li><li><a href="pn_expressions/#PostNewtonian.Œ©‚Éó·µ™‚ÇÇ-NTuple{13, Any}"><code>PostNewtonian.Œ©‚Éó·µ™‚ÇÇ</code></a></li><li><a href="pn_expressions/#PostNewtonian.Œ©‚Éó‚Çö-NTuple{13, Any}"><code>PostNewtonian.Œ©‚Éó‚Çö</code></a></li><li><a href="pn_expressions/#PostNewtonian.Œ≥-NTuple{13, Any}"><code>PostNewtonian.Œ≥</code></a></li><li><a href="utilities/#PostNewtonian.Œ¥-Tuple{Any, Any}"><code>PostNewtonian.Œ¥</code></a></li><li><a href="utilities/#PostNewtonian.ŒªÃÇ"><code>PostNewtonian.ŒªÃÇ</code></a></li><li><a href="utilities/#PostNewtonian.Œº-Tuple{Any, Any}"><code>PostNewtonian.Œº</code></a></li><li><a href="utilities/#PostNewtonian.ŒΩ-Tuple{Any, Any}"><code>PostNewtonian.ŒΩ</code></a></li><li><a href="utilities/#PostNewtonian.œá‚Çê-NTuple{4, Any}"><code>PostNewtonian.œá‚Çê</code></a></li><li><a href="utilities/#PostNewtonian.œá‚Çõ-NTuple{4, Any}"><code>PostNewtonian.œá‚Çõ</code></a></li><li><a href="utilities/#PostNewtonian.œá‚Éó-Tuple{Any, Any}"><code>PostNewtonian.œá‚Éó</code></a></li><li><a href="utilities/#PostNewtonian.‚ÑìÃÇ"><code>PostNewtonian.‚ÑìÃÇ</code></a></li><li><a href="utilities/#PostNewtonian.‚Ñ≥-Tuple{Any, Any}"><code>PostNewtonian.‚Ñ≥</code></a></li><li><a href="pn_expressions/#PostNewtonian.ùìî-NTuple{6, Any}"><code>PostNewtonian.ùìî</code></a></li><li><a href="pn_expressions/#PostNewtonian.ùìîNS-NTuple{15, Any}"><code>PostNewtonian.ùìîNS</code></a></li><li><a href="pn_expressions/#PostNewtonian.ùìî‚Ä≤-NTuple{13, Any}"><code>PostNewtonian.ùìî‚Ä≤</code></a></li><li><a href="pn_expressions/#PostNewtonian.ùìï-NTuple{13, Any}"><code>PostNewtonian.ùìï</code></a></li><li><a href="pn_expressions/#PostNewtonian.ùìïNS-NTuple{15, Any}"><code>PostNewtonian.ùìïNS</code></a></li><li><a href="pn_expressions/#PostNewtonian.ùõ°-NTuple{13, Any}"><code>PostNewtonian.ùõ°</code></a></li></ul><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>Here, the <code>i</code>th variable just refers to which number it has in the list   of evolved variables in the ODE system, as described under &quot;ODE system&quot;.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="pn_expressions/">PN expressions ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.21 on <span class="colophon-date" title="Wednesday 18 January 2023 16:15">Wednesday 18 January 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
